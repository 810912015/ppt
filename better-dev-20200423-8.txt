{"l":"https://web.stanford.edu/class/cs253/","n":"Stanford: CS 253 Web Security","html":"\n    <div class=\"content\">\n      <a href=\"https://cs253.stanford.edu\" class=\"logo\">\n        <img src=\"stanford.svg\" alt=\"Stanford\">\n        <h1>CS 253 Web Security</h1>\n      </a>\n\n      <h2>Fall 2019</h2>\n<p>This course is a comprehensive overview of web security. The goal is to build an understanding of the most common web attacks and their countermeasures. Given the pervasive insecurity of the modern web landscape, there is a pressing need for programmers and system designers to improve their understanding of web security issues.</p>\n<p>We'll be covering the fundamentals as well as the state-of-the-art in web security.</p>\n<p>Topics include: Principles of web security, attacks and countermeasures, the browser security model, web app vulnerabilities, injection, denial-of-service, TLS attacks, privacy, fingerprinting, same-origin policy, cross site scripting, authentication, JavaScript security, emerging threats, defense-in-depth, and techniques for writing secure code. Course projects include writing security exploits, defending insecure web apps, and implementing emerging web standards.</p>\n<h2>Meeting time and place</h2>\n<p>Tuesdays and Thursdays, 1:30 PM - 2:50 PM in classroom <a href=\"https://campus-map.stanford.edu/?srch=380-380Y\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">380-380Y</a></p>\n<h2>Course Staff</h2>\n<h3>Instructor</h3>\n<p>Feross Aboukhadijeh (<a href=\"mailto:feross@cs.stanford.edu\">feross@cs.stanford.edu</a>)</p>\n<h3>Teaching Assistant</h3>\n<p>Esther Goldstein (<a href=\"mailto:egolds@stanford.edu\">egolds@stanford.edu</a>)</p>\n<h3>Office Hours</h3>\n<ul>\n<li>Feross: Thursday 3-5pm, Gates 323</li>\n<li>Esther: Monday 3-5pm, Wednesday 3-5pm, Huang Basement</li>\n</ul>\n<h2>Course Policies</h2>\n<h3>Communication</h3>\n<p>We will primarily use <a href=\"https://piazza.com/stanford/fall2019/cs253\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Piazza</a> for sending out course announcements and answering questions. Please make sure to <a href=\"https://piazza.com/stanford/fall2019/cs253\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sign up</a>.</p>\n<p>We use <a href=\"https://gradescope.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Gradescope</a> for assignment submissions. Enroll with the code <code>97BGZB</code>.</p>\n<p>To submit anonymous feedback to us at any point during the quarter, you may use <a href=\"https://forms.gle/WqKuxA2m7oycRuTt7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">this form</a>.</p>\n<h3>Prerequisites</h3>\n<p>CS 142, or an equivalent amount of web development experience, is a prerequisite. You should also be curious about web security and excited to learn clever attacks, defenses, and techniques for writing secure code.</p>\n<p>An introductory security course, such as CS 155, is not a formal prerequisite. The material in this course is focused specifically on the web, while CS 155 covers security more broadly.</p>\n<h3>Attendence</h3>\n<p>Attendance at lectures is mandatory. Do not enroll in this course if you are taking another course that meets at the same time.</p>\n<h3>Grading</h3>\n<ul>\n<li>Assignments (75%)</li>\n<li>Final Exam (25%)</li>\n</ul>\n<p>Each assignment is worth 15%. There is no midterm.</p>\n<h3>Final Exam</h3>\n<ul>\n<li>Tuesday, December 10, 3:30pm - 6:30pm in <a href=\"https://campus-map.stanford.edu/?srch=200-305\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">200-305</a></li>\n</ul>\n<h3>Previous Final Exams</h3>\n<ul>\n<li><a href=\"cs253-final-2019.pdf\">Final Exam 2019</a> (<a href=\"cs253-final-2019-solutions.pdf\">Solutions</a>)</li>\n<li><a href=\"cs253-sample-final.pdf\">More Sample Final Exam Questions</a> (<a href=\"cs253-sample-final-solutions.pdf\">Solutions</a>)</li>\n</ul>\n<h3>Collaboration Policy</h3>\n<p>You may discuss the assignments with other students and you may work together to come up with solutions to the problems. If you do so, you must list the name of your collaborators in the submission. Each student must write up their solutions independently.</p>\n<h3>Late Submissions</h3>\n<p>You get three â€œlate daysâ€ in total during the quarter. You may use a late day to submit an assignment after the deadline. You can use at most three late days for any single assignment, and you may only use late days in one-day increments (no partial late days).</p>\n<p>If you submit an assignment more than 72 hours after the deadline, or if you submit an assignment late after running out of late days, you will receive <strong>no credit</strong> for the submission. Please submit your assignments on time and save your late days for extraordinary situations.</p>\n<p>If you have questions about these policies, please ask us.</p>\n<h2>Schedule</h2>\n<h3>Sep 24: What is Web Security? HTML &amp; JavaScript Review</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2001.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=5JJrJGZ_LjM\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://developers.google.com/web/updates/2018/09/inside-browser-part1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Inside look at modern web browser (part 1)</a></li>\n<li><a href=\"https://developers.google.com/web/updates/2018/09/inside-browser-part2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Inside look at modern web browser (part 2)</a></li>\n<li><a href=\"https://developers.google.com/web/updates/2018/09/inside-browser-part3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Inside look at modern web browser (part 3)</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/A_re-introduction_to_JavaScript\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">A Re-Introduction to JavaScript</a></li>\n</ul></li>\n</ul>\n<h3>Sep 26: HTTP, Cookies, Sessions</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2002.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=zhnQFQ2qFtA\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Overview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">An overview of HTTP</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">HTTP Cookies</a></li>\n<li>Skim: <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">HTTP headers</a></li>\n</ul></li>\n</ul>\n<h3>Oct 01: Session Attacks</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2003.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=QuhgjXKzfI8\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://web.dev/samesite-cookies-explained/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SameSite Cookies Explained</a></li>\n<li><a href=\"https://tools.ietf.org/html/draft-west-cookie-incrementalism-00#section-4.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Incrementally Better Cookies</a></li>\n<li><a href=\"https://scotthelme.co.uk/csrf-is-dead/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CSRF Is Dead</a></li>\n</ul></li>\n</ul>\n<h3>Oct 03: Cross-Site Request Forgery, Same Origin Policy</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2004.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=0-q69vAYSwo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Same Origin policy</a></li>\n<li><a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Cross-Site Request Forgery Prevention</a></li>\n</ul></li>\n</ul>\n<h3>Oct 08: Exceptions to the Same Origin Policy, Cross-Site Script Inclusion</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2005.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=ud9cVQDte3A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n</ul>\n<h3>Oct 10: Cross-Site Scripting (XSS)</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2006.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=XTcqlOFhpPI\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Cross Site Scripting Prevention Cheat Sheet</a></li>\n<li><a href=\"https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">XSS Filter Evasion Cheat Sheet</a></li>\n</ul></li>\n</ul>\n<h3>Oct 15: Cross-Site Scripting Defenses</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2007.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=PlXzrtheQGc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"http://research.sidstamm.com/papers/csp-www2010.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Reining in the Web with Content Security Policy</a></li>\n<li><a href=\"https://storage.googleapis.com/pub-tools-public-publication-data/pdf/45542.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CSP is Dead: Long Live CSP</a></li>\n<li><a href=\"https://developers.google.com/web/updates/2019/02/trusted-types\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Trusted Types</a></li>\n<li><a href=\"https://fastmail.blog/2015/12/20/sanitising-html-the-dom-clobbering-issue/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Sanitising HTML: the DOM clobbering issue</a></li>\n</ul></li>\n</ul>\n<h3>Oct 17: Fingerprinting and Privacy on the Web</h3>\n<ul>\n<li><strong>Guest Lecture by Pete Snyder (<a href=\"https://brave.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Brave Software</a>)</strong></li>\n<li><a href=\"lectures/Lecture%2008.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=OVh0oHbmla0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://chromium.woolyss.com/f/OpenWPM-1-million-site-tracking-measurement.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Online tracking: A 1-million-site measurement and analysis</a></li>\n<li><a href=\"https://arxiv.org/pdf/1708.08510\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Most websites don't need to vibrate: A cost-benefit approach to improving browser security</a></li>\n<li><a href=\"https://blog.torproject.org/browser-fingerprinting-introduction-and-challenges-ahead\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Browser Fingerprinting: An Introduction and the Challenges Ahead</a></li>\n<li><a href=\"https://webkit.org/blog/8943/privacy-preserving-ad-click-attribution-for-the-web/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebKit Ad Click Attribution</a></li>\n<li><a href=\"https://crypto.stanford.edu/safecache/sameorigin.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Protecting Browser State from Web Privacy Attacks</a></li>\n<li>Skim: <a href=\"https://webkit.org/tracking-prevention-policy/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebKit Tracking Prevention Policy</a></li>\n</ul></li>\n</ul>\n<h3>Oct 22: Denial-of-service, Phishing, Side Channels</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2009.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=RfC_PzVmk4w\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://www.usenix.org/system/files/conference/usenixsecurity13/sec13-paper_akhawe.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Alice in Warningland: A Large-Scale Field Study of Browser Security</a></li>\n<li><a href=\"http://www.sectheory.com/clickjacking.htm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Clickjacking</a></li>\n<li><a href=\"https://www.adambarth.com/papers/2009/barth-weinberger-song.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Cross-Origin JavaScript Capability Leaks: Detection, Exploitation, and Defense</a></li>\n</ul></li>\n</ul>\n<h3>Oct 24: Code Injection</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2010.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=mR7yvqWmE0M\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li>None</li>\n</ul></li>\n</ul>\n<h3>Oct 29: Transport Layer Security</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2011.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=S8-rnPHjyxs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://blog.cryptographyengineering.com/2019/09/24/looking-back-at-the-snowden-revelations/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Looking back at the Snowden revelations</a></li>\n<li><a href=\"https://transparencyreport.google.com/https/overview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">HTTPS encryption on the web</a></li>\n</ul></li>\n</ul>\n<h3>Oct 31: HTTPS in the Real World: A Spooky Tale</h3>\n<ul>\n<li><strong>Guest Lecture by Emily Stark &amp; Chris Palmer (<a href=\"https://www.google.com/chrome/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Google Chrome</a>)</strong></li>\n<li><a href=\"lectures/Lecture%2012.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=jN26N8QS5Os\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/DigiNotar\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">DigiNotar on Wikipedia</a></li>\n<li><a href=\"https://noncombatant.org/2015/05/01/about-http-public-key-pinning/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">About Public Key Pinning</a></li>\n<li><a href=\"https://noncombatant.org/2015/11/24/what-is-hpkp-for/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">What Is HPKP For?</a></li>\n<li><a href=\"https://developers.google.com/web/updates/2015/09/HPKP-reporting-with-chrome-46\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Rolling out Public Key Pinning with HPKP Reporting</a></li>\n</ul></li>\n</ul>\n<h3>Nov 05: Authentication</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2013.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=lgmGSYwJc20\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Authentication Cheat Sheet</a></li>\n</ul></li>\n</ul>\n<h3>Nov 07: WebAuthn - The future of user authentication on the web ğŸ¤</h3>\n<ul>\n<li><strong>Guest Lecture by Lucas Garron (<a href=\"https://github.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub</a>)</strong></li>\n<li><a href=\"lectures/Lecture%2014.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=_nPk2HgNpjE\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://webauthn.guide/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Guide to Web Authentication</a></li>\n</ul></li>\n</ul>\n<h3>Nov 12: No class</h3>\n<h3>Nov 14: Managing security concerns in a large Open Source project</h3>\n<ul>\n<li><strong>Guest Lecture by Myles Borins (<a href=\"https://nodejs.org/en/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Node.js</a> technical steering committee, <a href=\"https://www.google.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Google</a>)</strong></li>\n<li><a href=\"https://kni.sh/oss-security\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=lX6KLL0sVTU\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://gruss.cc/files/fantastictimers.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fantastic Timers and Where to Find Them: High-Resolution Microarchitectural Attacks in JavaScript</a></li>\n<li><a href=\"https://nodesecroadmap.fyi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">A Roadmap for Node.js Security</a></li>\n</ul></li>\n</ul>\n<h3>Nov 19: Server security, Safe coding practices</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2017.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=Ox15IMOvWfA\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://snyk.io/blog/exploiting-buffer/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Exploiting Buffer</a></li>\n</ul></li>\n</ul>\n<h3>Nov 21: Local HTTP server security</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2018.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=wLgcb4jZwGM\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li>None</li>\n</ul></li>\n</ul>\n<h3>Dec 03: DNS rebinding attacks</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2019.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=bZW_55LIz0w\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://www.wired.com/story/chromecast-roku-sonos-dns-rebinding-vulnerability/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Millions of Streaming Devices Are Vulnerable to a Retro Web Attack</a></li>\n<li><a href=\"https://crypto.stanford.edu/dns/dns-rebinding.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Protecting Browsers from DNS Rebinding Attacks</a></li>\n</ul></li>\n</ul>\n<h3>Dec 05: Browser architecture, Writing secure code</h3>\n<ul>\n<li><a href=\"lectures/Lecture%2020.pdf\">Slides</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=5aguccOpGes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Video</a></li>\n<li>Reading<ul>\n<li><a href=\"https://seclab.stanford.edu/websec/chromium/chromium-security-architecture.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">The Security Architecture of the Chromium Browser</a></li>\n<li><a href=\"https://www.chromium.org/Home/chromium-security/corb-for-developers\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Cross-Origin Read Blocking (CORB) primer</a></li>\n<li>Skim: <a href=\"https://chromium.googlesource.com/chromium/src/+/master/services/network/cross_origin_read_blocking_explainer.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Cross-Origin Read Blocking (CORB) explainer</a></li>\n<li><a href=\"https://diracdeltas.github.io/blog/backdooring-js/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Backdooring Your JavaScript Using Minifier Bugs</a></li>\n<li><a href=\"https://medium.com/hackernoon/im-harvesting-credit-card-numbers-and-passwords-from-your-site-here-s-how-9a8cb347c5b5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Iâ€™m harvesting credit card numbers and passwords from your site. Hereâ€™s how.</a></li>\n<li><a href=\"https://shkspr.mobi/blog/2018/11/major-sites-running-unauthenticated-javascript-on-their-payment-pages/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Major sites running unauthenticated JavaScript on their payment pages</a></li>\n</ul></li>\n</ul>\n<h2>Assignments</h2>\n<h3><a href=\"assign0\">Assignment 0 â€“ Web Programming Adventure âœˆï¸</a></h3>\n<ul>\n<li>Assigned: Tuesday, September 24</li>\n<li>Due: Friday, October 4 at 5:00pm</li>\n</ul>\n<h3><a href=\"assign1\">Assignment 1 â€“ Journey to the Dark Side ğŸŒ˜</a></h3>\n<ul>\n<li>Assigned: Tuesday, October 8</li>\n<li>Due: Friday, October 18 at 5:00pm</li>\n</ul>\n<h3><a href=\"assign2\">Assignment 2 â€“ Oh What a Tangled Web We Weave ğŸ•¸</a></h3>\n<ul>\n<li>Assigned: Saturday, October 26</li>\n<li>Due: Thursday, November 7 at 11:59pm</li>\n</ul>\n<h3>Assignment 3 â€“ See Piazza</h3>\n<ul>\n<li>Assigned: Tuesday, November 12</li>\n<li>Due: Friday, November 22 at 5:00pm</li>\n</ul>\n<h3>Assignment 4 â€“ See Piazza</h3>\n<ul>\n<li>Assigned: Mon, November 25</li>\n<li>Due: Friday, December 6 at 5:00pm</li>\n</ul>\n<br>\n<br>\n<br>\n<p>Website design by <a href=\"https://feross.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Feross Aboukhadijeh</a>.</p>\n\n    </div>\n  \n\n","text":"CS 253 Web Security Fall 2019\nThis course is a comprehensive overview of web security. The goal is to build an understanding of the most common web attacks and their countermeasures. Given the pervasive insecurity of the modern web landscape, there is a pressing need for programmers and system designers to improve their understanding of web security issues.\nWe'll be covering the fundamentals as well as the state-of-the-art in web security.\nTopics include: Principles of web security, attacks and countermeasures, the browser security model, web app vulnerabilities, injection, denial-of-service, TLS attacks, privacy, fingerprinting, same-origin policy, cross site scripting, authentication, JavaScript security, emerging threats, defense-in-depth, and techniques for writing secure code. Course projects include writing security exploits, defending insecure web apps, and implementing emerging web standards.\nMeeting time and place\nTuesdays and Thursdays, 1:30 PM - 2:50 PM in classroom 380-380Y\nCourse Staff Instructor\nFeross Aboukhadijeh (feross@cs.stanford.edu)\nTeaching Assistant\nEsther Goldstein (egolds@stanford.edu)\nOffice Hours\nFeross: Thursday 3-5pm, Gates 323\nEsther: Monday 3-5pm, Wednesday 3-5pm, Huang Basement\nCourse Policies Communication\nWe will primarily use Piazza for sending out course announcements and answering questions. Please make sure to sign up.\nWe use Gradescope for assignment submissions. Enroll with the code 97BGZB.\nTo submit anonymous feedback to us at any point during the quarter, you may use this form.\nPrerequisites\nCS 142, or an equivalent amount of web development experience, is a prerequisite. You should also be curious about web security and excited to learn clever attacks, defenses, and techniques for writing secure code.\nAn introductory security course, such as CS 155, is not a formal prerequisite. The material in this course is focused specifically on the web, while CS 155 covers security more broadly.\nAttendence\nAttendance at lectures is mandatory. Do not enroll in this course if you are taking another course that meets at the same time.\nGrading\nAssignments (75%)\nFinal Exam (25%)\nEach assignment is worth 15%. There is no midterm.\nFinal Exam\nTuesday, December 10, 3:30pm - 6:30pm in 200-305\nPrevious Final Exams\nFinal Exam 2019 (Solutions)\nMore Sample Final Exam Questions (Solutions)\nCollaboration Policy\nYou may discuss the assignments with other students and you may work together to come up with solutions to the problems. If you do so, you must list the name of your collaborators in the submission. Each student must write up their solutions independently.\nLate Submissions\nYou get three â€œlate daysâ€ in total during the quarter. You may use a late day to submit an assignment after the deadline. You can use at most three late days for any single assignment, and you may only use late days in one-day increments (no partial late days).\nIf you submit an assignment more than 72 hours after the deadline, or if you submit an assignment late after running out of late days, you will receive no credit for the submission. Please submit your assignments on time and save your late days for extraordinary situations.\nIf you have questions about these policies, please ask us.\nSchedule Sep 24: What is Web Security? HTML &amp; JavaScript Review\nSlides\nVideo\nReading\nInside look at modern web browser (part 1)\nInside look at modern web browser (part 2)\nInside look at modern web browser (part 3)\nA Re-Introduction to JavaScript\nSep 26: HTTP, Cookies, Sessions\nSlides\nVideo\nReading\nAn overview of HTTP\nHTTP Cookies\nSkim: HTTP headers\nOct 01: Session Attacks\nSlides\nVideo\nReading\nSameSite Cookies Explained\nIncrementally Better Cookies\nCSRF Is Dead\nOct 03: Cross-Site Request Forgery, Same Origin Policy\nSlides\nVideo\nReading\nSame Origin policy\nCross-Site Request Forgery Prevention\nOct 08: Exceptions to the Same Origin Policy, Cross-Site Script Inclusion\nSlides\nVideo\nOct 10: Cross-Site Scripting (XSS)\nSlides\nVideo\nReading\nCross Site Scripting Prevention Cheat Sheet\nXSS Filter Evasion Cheat Sheet\nOct 15: Cross-Site Scripting Defenses\nSlides\nVideo\nReading\nReining in the Web with Content Security Policy\nCSP is Dead: Long Live CSP\nTrusted Types\nSanitising HTML: the DOM clobbering issue\nOct 17: Fingerprinting and Privacy on the Web\nGuest Lecture by Pete Snyder (Brave Software)\nSlides\nVideo\nReading\nOnline tracking: A 1-million-site measurement and analysis\nMost websites don't need to vibrate: A cost-benefit approach to improving browser security\nBrowser Fingerprinting: An Introduction and the Challenges Ahead\nWebKit Ad Click Attribution\nProtecting Browser State from Web Privacy Attacks\nSkim: WebKit Tracking Prevention Policy\nOct 22: Denial-of-service, Phishing, Side Channels\nSlides\nVideo\nReading\nAlice in Warningland: A Large-Scale Field Study of Browser Security\nClickjacking\nCross-Origin JavaScript Capability Leaks: Detection, Exploitation, and Defense\nOct 24: Code Injection\nSlides\nVideo\nReading\nNone\nOct 29: Transport Layer Security\nSlides\nVideo\nReading\nLooking back at the Snowden revelations\nHTTPS encryption on the web\nOct 31: HTTPS in the Real World: A Spooky Tale\nGuest Lecture by Emily Stark &amp; Chris Palmer (Google Chrome)\nSlides\nVideo\nReading\nDigiNotar on Wikipedia\nAbout Public Key Pinning\nWhat Is HPKP For?\nRolling out Public Key Pinning with HPKP Reporting\nNov 05: Authentication\nSlides\nVideo\nReading\nAuthentication Cheat Sheet\nNov 07: WebAuthn - The future of user authentication on the web ğŸ¤\nGuest Lecture by Lucas Garron (GitHub)\nSlides\nVideo\nReading\nGuide to Web Authentication\nNov 12: No class Nov 14: Managing security concerns in a large Open Source project\nGuest Lecture by Myles Borins (Node.js technical steering committee, Google)\nSlides\nVideo\nReading\nFantastic Timers and Where to Find Them: High-Resolution Microarchitectural Attacks in JavaScript\nA Roadmap for Node.js Security\nNov 19: Server security, Safe coding practices\nSlides\nVideo\nReading\nExploiting Buffer\nNov 21: Local HTTP server security\nSlides\nVideo\nReading\nNone\nDec 03: DNS rebinding attacks\nSlides\nVideo\nReading\nMillions of Streaming Devices Are Vulnerable to a Retro Web Attack\nProtecting Browsers from DNS Rebinding Attacks\nDec 05: Browser architecture, Writing secure code\nSlides\nVideo\nReading\nThe Security Architecture of the Chromium Browser\nCross-Origin Read Blocking (CORB) primer\nSkim: Cross-Origin Read Blocking (CORB) explainer\nBackdooring Your JavaScript Using Minifier Bugs\nIâ€™m harvesting credit card numbers and passwords from your site. Hereâ€™s how.\nMajor sites running unauthenticated JavaScript on their payment pages\nAssignments Assignment 0 â€“ Web Programming Adventure âœˆï¸\nAssigned: Tuesday, September 24\nDue: Friday, October 4 at 5:00pm\nAssignment 1 â€“ Journey to the Dark Side ğŸŒ˜\nAssigned: Tuesday, October 8\nDue: Friday, October 18 at 5:00pm\nAssignment 2 â€“ Oh What a Tangled Web We Weave ğŸ•¸\nAssigned: Saturday, October 26\nDue: Thursday, November 7 at 11:59pm\nAssignment 3 â€“ See Piazza\nAssigned: Tuesday, November 12\nDue: Friday, November 22 at 5:00pm\nAssignment 4 â€“ See Piazza\nAssigned: Mon, November 25\nDue: Friday, December 6 at 5:00pm\nWebsite design by Feross Aboukhadijeh.","ctext":"CS 253ç½‘ç»œå®‰å…¨ç§‹å­£2019\næœ¬è¯¾ç¨‹æ˜¯ç½‘ç»œå®‰å…¨çš„å…¨é¢æ¦‚è¿°ã€‚ ç›®çš„æ˜¯åŠ æ·±å¯¹æœ€å¸¸è§çš„Webæ”»å‡»åŠå…¶å¯¹ç­–çš„ç†è§£ã€‚ é‰´äºç°ä»£Webé¢†åŸŸæ™®éå­˜åœ¨çš„ä¸å®‰å…¨å› ç´ ï¼Œè¿«åˆ‡éœ€è¦ç¨‹åºå‘˜å’Œç³»ç»Ÿè®¾è®¡äººå‘˜æé«˜å¯¹Webå®‰å…¨é—®é¢˜çš„ç†è§£ã€‚\næˆ‘ä»¬å°†ä»‹ç»Webå®‰å…¨çš„åŸºç¡€çŸ¥è¯†å’Œæœ€æ–°æŠ€æœ¯ã€‚\nä¸»é¢˜åŒ…æ‹¬ï¼šç½‘ç»œå®‰å…¨åŸç†ï¼Œæ”»å‡»å’Œå¯¹ç­–ï¼Œæµè§ˆå™¨å®‰å…¨æ¨¡å‹ï¼Œç½‘ç»œåº”ç”¨æ¼æ´ï¼Œæ³¨å…¥ï¼Œæ‹’ç»æœåŠ¡ï¼ŒTLSæ”»å‡»ï¼Œéšç§ï¼ŒæŒ‡çº¹è¯†åˆ«ï¼ŒåŒæºç­–ç•¥ï¼Œè·¨ç«™ç‚¹è„šæœ¬ï¼Œèº«ä»½éªŒè¯ï¼ŒJavaScriptå®‰å…¨ï¼Œ æ–°å…´çš„å¨èƒï¼Œçºµæ·±é˜²å¾¡ä»¥åŠç¼–å†™å®‰å…¨ä»£ç çš„æŠ€æœ¯ã€‚ è¯¾ç¨‹é¡¹ç›®åŒ…æ‹¬ç¼–å†™å®‰å…¨æ¼æ´ï¼Œé˜²å¾¡ä¸å®‰å…¨çš„Webåº”ç”¨ç¨‹åºä»¥åŠå®ç°æ–°å…´çš„Webæ ‡å‡†ã€‚\nä¼šè®®æ—¶é—´å’Œåœ°ç‚¹\næ˜ŸæœŸäºŒå’Œæ˜ŸæœŸå››ï¼Œ1:30 PM-2:50 PMåœ¨æ•™å®¤380-380Y\nè¯¾ç¨‹æ•™å‘˜\né˜¿å¸ƒÂ·å“ˆè¿ªè´¾ï¼ˆAbu Khadijaï¼‰çš„æœºä¼šï¼ˆ@ X. Stanford.Memberçš„æœºä¼šï¼‰\næ•™å­¦åŠ©æ‰‹\nEsther Goldsteinï¼ˆegolds@stanford.eduï¼‰\nå·¥ä½œæ—¶é—´\nFerossï¼šæ˜ŸæœŸå››3-5pmï¼Œç›–èŒ¨323\nä»¥æ–¯å¸–ï¼šæ˜ŸæœŸä¸€3-5pmï¼Œæ˜ŸæœŸä¸‰3-5pmï¼Œé»„åœ°ä¸‹å®¤\nè¯¾ç¨‹æ”¿ç­–äº¤æµ\næˆ‘ä»¬å°†ä¸»è¦ä½¿ç”¨Piazzaå‘å‡ºè¯¾ç¨‹å…¬å‘Šå’Œå›ç­”é—®é¢˜ã€‚ è¯·ç¡®ä¿æ³¨å†Œã€‚\næˆ‘ä»¬ä½¿ç”¨Gradescopeæäº¤ä½œä¸šã€‚ æ³¨å†Œä»£ç ä¸º97BGZBã€‚\nè¦åœ¨æœ¬å­£åº¦çš„ä»»ä½•æ—¶å€™å‘æˆ‘ä»¬æäº¤åŒ¿ååé¦ˆï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤è¡¨æ ¼ã€‚\nå…ˆå†³æ¡ä»¶\nå…ˆå†³æ¡ä»¶æ˜¯CS 142æˆ–åŒç­‰çš„Webå¼€å‘ç»éªŒã€‚ æ‚¨è¿˜åº”è¯¥å¯¹Webå®‰å…¨æ„Ÿåˆ°å¥½å¥‡ï¼Œå¹¶ä¹äºå­¦ä¹ èªæ˜çš„æ”»å‡»ï¼Œé˜²å¾¡æªæ–½å’Œç¼–å†™å®‰å…¨ä»£ç çš„æŠ€æœ¯ã€‚\nå…¥é—¨çº§å®‰å…¨è¯¾ç¨‹ï¼Œä¾‹å¦‚CS 155ï¼Œä¸æ˜¯æ­£å¼çš„å…ˆå†³æ¡ä»¶ã€‚ æœ¬è¯¾ç¨‹ä¸­çš„ææ–™ä¸“é—¨é’ˆå¯¹Webï¼Œè€ŒCS 155æ¶µç›–äº†æ›´å¹¿æ³›çš„å®‰å…¨æ€§ã€‚\nå‡ºå¸­äººæ•°\nå¿…é¡»å‚åŠ è®²åº§ã€‚ å¦‚æœæ‚¨è¦åŒæ—¶ä¿®è¯»å¦ä¸€é—¨è¯¾ç¨‹ï¼Œè¯·ä¸è¦æ³¨å†Œè¯¥è¯¾ç¨‹ã€‚\nç­‰çº§\nä½œä¸šï¼ˆ75ï¼…ï¼‰\næœŸæœ«è€ƒè¯•ï¼ˆ25ï¼…ï¼‰\næ¯é¡¹ä½œä¸šçš„ä»·å€¼ä¸º15ï¼…ã€‚ æ²¡æœ‰æœŸä¸­è€ƒè¯•ã€‚\næœŸæœ«è€ƒè¯•\n200-305å¹´12æœˆ10æ—¥ï¼Œæ˜ŸæœŸäºŒï¼Œä¸‹åˆ3:30-ä¸‹åˆ6:30\nä»¥å‰çš„æœŸæœ«è€ƒè¯•\n2019å¹´æœŸæœ«è€ƒè¯•ï¼ˆè§£å†³æ–¹æ¡ˆï¼‰\næ›´å¤šæœŸæœ«è€ƒè¯•æ ·é¢˜ï¼ˆè§£å†³æ–¹æ¡ˆï¼‰\nåˆä½œæ”¿ç­–\næ‚¨å¯ä»¥ä¸å…¶ä»–å­¦ç”Ÿè®¨è®ºä½œä¸šï¼Œä¹Ÿå¯ä»¥ä¸€èµ·æå‡ºé—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ å¦‚æœè¿™æ ·åšï¼Œåˆ™å¿…é¡»åœ¨æäº¤ä¸­åˆ—å‡ºåä½œè€…çš„å§“åã€‚ æ¯ä¸ªå­¦ç”Ÿå¿…é¡»ç‹¬ç«‹ç¼–å†™ä»–ä»¬çš„è§£å†³æ–¹æ¡ˆã€‚\né€¾æœŸæäº¤\nåœ¨è¯¥å­£åº¦ä¸­ï¼Œæ‚¨æ€»å…±æœ‰3ä¸ªâ€œåæœŸâ€ã€‚ æ‚¨å¯ä»¥åœ¨æˆªæ­¢æ—¥æœŸä¹‹åç”¨è¾ƒæ™šçš„æ—¶é—´æäº¤ä½œä¸šã€‚ æ‚¨ä¸€æ¬¡æœ€å¤šåªèƒ½ä½¿ç”¨ä¸‰å¤©çš„å»¶è¿Ÿæ—¶é—´ï¼Œå¹¶ä¸”åªèƒ½ä»¥ä¸€å¤©çš„å¢é‡ä½¿ç”¨å»¶è¿Ÿçš„æ—¶é—´ï¼ˆä¸èƒ½éƒ¨åˆ†å»¶è¿Ÿï¼‰ã€‚\nå¦‚æœæ‚¨åœ¨æˆªæ­¢æ—¥æœŸåè¶…è¿‡72å°æ—¶æäº¤ä½œä¸šï¼Œæˆ–è€…å¦‚æœæ‚¨åœ¨è¿Ÿåˆ°çš„å·¥ä½œæ—¥åæäº¤ä½œä¸šï¼Œæ‚¨å°†ä¸ä¼šè·å¾—ä»»ä½•ä¿¡ç”¨ã€‚ è¯·å‡†æ—¶æäº¤ä½œä¸šï¼Œå¹¶åœ¨ç‰¹æ®Šæƒ…å†µä¸‹èŠ‚çœæ‚¨çš„å»¶è¿Ÿæ—¶é—´ã€‚\nå¦‚æœæ‚¨å¯¹è¿™äº›æ”¿ç­–æœ‰ç–‘é—®ï¼Œè¯·è¯¢é—®æˆ‘ä»¬ã€‚\nå¦‚æœæ‚¨å¯¹è¿™äº›æ”¿ç­–æœ‰ç–‘é—®ï¼Œè¯·è¯¢é—®æˆ‘ä»¬ã€‚...\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\næ·±å…¥äº†è§£ç°ä»£Webæµè§ˆå™¨ï¼ˆç¬¬1éƒ¨åˆ†ï¼‰\næ·±å…¥äº†è§£ç°ä»£Webæµè§ˆå™¨ï¼ˆç¬¬2éƒ¨åˆ†ï¼‰\næ·±å…¥äº†è§£ç°ä»£Webæµè§ˆå™¨ï¼ˆç¬¬3éƒ¨åˆ†ï¼‰\nJavaScriptçš„é‡æ–°ä»‹ç»\n9æœˆ26æ—¥ï¼šHTTPï¼ŒCookieï¼Œä¼šè¯\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nHTTPæ¦‚è¿°\nHTTP Cookie\nç•¥è¯»ï¼šHTTPæ ‡å¤´\n10æœˆ1æ—¥ï¼šä¼šè¯æ”»å‡»\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nSameSite Cookiesè§£é‡Š\né€æ­¥æ”¹å–„Cookie\nCSRFå·²æ­»\n10æœˆ3æ—¥ï¼šè·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ï¼ŒåŒæºç­–ç•¥\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nåŒæºæ”¿ç­–\nè·¨ç«™è¯·æ±‚ä¼ªé€ é¢„é˜²\n10æœˆ8æ—¥ï¼šç›¸åŒèµ·æºç­–ç•¥çš„ä¾‹å¤–ï¼Œè·¨ç«™ç‚¹è„šæœ¬åŒ…å«\næ»‘æ¢¯\nè§†é¢‘\n10æœˆ10æ—¥ï¼šè·¨ç«™è„šæœ¬ï¼ˆXSSï¼‰\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nè·¨ç«™ç‚¹è„šæœ¬é˜²æŠ¤å¤‡å¿˜å•\nXSSè¿‡æ»¤å™¨è§„é¿é€ŸæŸ¥è¡¨\n10æœˆ15æ—¥ï¼šè·¨ç«™è„šæœ¬é˜²æŠ¤\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\né€šè¿‡å†…å®¹å®‰å…¨ç­–ç•¥æ§åˆ¶Web\nCSPå·²æ­»ï¼šCSPä¸‡å²\nå¯ä¿¡ç±»å‹\næ¸…ç†HTMLï¼šDOMç ´åé—®é¢˜\n10æœˆ17æ—¥ï¼šç½‘ç»œä¸Šçš„æŒ‡çº¹å’Œéšç§\nPete Snyderçš„å®¢åº§æ¼”è®²ï¼ˆå‹‡æ•¢çš„è½¯ä»¶ï¼‰\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nåœ¨çº¿è·Ÿè¸ªï¼šä¸€ç™¾ä¸‡ä¸ªç«™ç‚¹çš„æµ‹é‡å’Œåˆ†æ\nå¤§å¤šæ•°ç½‘ç«™ä¸éœ€è¦æŒ¯åŠ¨ï¼šä¸€ç§æé«˜æµè§ˆå™¨å®‰å…¨æ€§çš„æˆæœ¬æ•ˆç›Šæ–¹æ³•\næµè§ˆå™¨æŒ‡çº¹ï¼šç®€ä»‹å’Œæœªæ¥çš„æŒ‘æˆ˜\nWebKitå¹¿å‘Šç‚¹å‡»å½’å› \nä¿æŠ¤æµè§ˆå™¨çŠ¶æ€å…å—Webéšç§æ”»å‡»\nç•¥è¯»ï¼šWebKitè·Ÿè¸ªé¢„é˜²ç­–ç•¥\n10æœˆ22æ—¥ï¼šæ‹’ç»æœåŠ¡ï¼Œç½‘ç»œé’“é±¼ï¼Œä¾§è¾¹æ¸ é“\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nçˆ±ä¸½ä¸æ¢¦æ¸¸ä»™å¢ƒï¼šæµè§ˆå™¨å®‰å…¨æ€§çš„å¤§è§„æ¨¡å®åœ°ç ”ç©¶\nç‚¹å‡»åŠ«æŒ\nè·¨åŸŸJavaScriptåŠŸèƒ½æ³„æ¼ï¼šæ£€æµ‹ï¼Œåˆ©ç”¨å’Œé˜²å¾¡\n10æœˆ24æ—¥ï¼šä»£ç æ³¨å…¥\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\næ²¡æœ‰\n10æœˆ29æ—¥ï¼šä¼ è¾“å±‚å®‰å…¨æ€§\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nå›é¡¾æ–¯è¯ºç™»çš„å¯ç¤º\nç½‘ç»œä¸Šçš„HTTPSåŠ å¯†\n10æœˆ31æ—¥ï¼šçœŸå®ä¸–ç•Œä¸­çš„HTTPSï¼šè¯¡å¼‚çš„æ•…äº‹\n10æœˆ31æ—¥ï¼šçœŸå®ä¸–ç•Œä¸­çš„HTTPSï¼šè¯¡å¼‚çš„æ•…äº‹...\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nç»´åŸºç™¾ç§‘ä¸Šçš„DigiNotar\nå…³äºå…¬é’¥å›ºå®š\nHPKPçš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ\né€šè¿‡HPKPæŠ¥å‘Šæ¨å‡ºå…¬é’¥å›ºå®š\n11æœˆ5æ—¥ï¼šèº«ä»½éªŒè¯\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nè®¤è¯å¤‡å¿˜å•\n11æœˆ7æ—¥ï¼šWebAuthn-ç½‘ç»œä¸Šç”¨æˆ·èº«ä»½éªŒè¯çš„æœªæ¥\nLucas Garronçš„å®¢åº§æ¼”è®²ï¼ˆGitHubï¼‰\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nWebè®¤è¯æŒ‡å—\n11æœˆ12æ—¥ï¼šä¸ä¸Šè¯¾11æœˆ14æ—¥ï¼šç®¡ç†å¤§å‹å¼€æºé¡¹ç›®ä¸­çš„å®‰å…¨é—®é¢˜\nMyles Borinsçš„å®¢åº§æ¼”è®²ï¼ˆNode.jsæŠ€æœ¯æŒ‡å¯¼å§”å‘˜ä¼šï¼ŒGoogleï¼‰\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nå¥‡å¦™çš„è®¡æ—¶å™¨ä»¥åŠåœ¨å“ªé‡Œæ‰¾åˆ°å®ƒä»¬ï¼šJavaScriptä¸­çš„é«˜åˆ†è¾¨ç‡å¾®ä½“ç³»ç»“æ„æ”»å‡»\nNode.jså®‰å…¨è·¯çº¿å›¾\n11æœˆ19æ—¥ï¼šæœåŠ¡å™¨å®‰å…¨æ€§ï¼Œå®‰å…¨çš„ç¼–ç åšæ³•\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nå¼€å‘ç¼“å†²åŒº\n11æœˆ21æ—¥ï¼šæœ¬åœ°HTTPæœåŠ¡å™¨å®‰å…¨æ€§\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\næ²¡æœ‰\n12æœˆ3æ—¥ï¼šDNSé‡æ–°ç»‘å®šæ”»å‡»\næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\næˆåƒä¸Šä¸‡çš„æµåª’ä½“è®¾å¤‡å®¹æ˜“é­å—å¤å¤Webæ”»å‡»\nä¿æŠ¤æµè§ˆå™¨å…å—DNSé‡æ–°ç»‘å®šæ”»å‡»\n12æœˆ5æ—¥ï¼šæµè§ˆå™¨æ¶æ„ï¼Œç¼–å†™å®‰å…¨ä»£ç \næ»‘æ¢¯\nè§†é¢‘\né˜…è¯»\nChromiumæµè§ˆå™¨çš„å®‰å…¨æ¶æ„\nè·¨åŸŸè¯»å–é˜»æ­¢ï¼ˆCORBï¼‰åº•æ¼†\nç•¥è¯»ï¼šè·¨åŸŸè¯»å–é˜»æ­¢ï¼ˆCORBï¼‰è§£é‡Šå™¨\nä½¿ç”¨Minifieré”™è¯¯å¯¹JavaScriptè¿›è¡Œåé—¨æ“ä½œ\næˆ‘æ­£åœ¨ä»æ‚¨çš„ç½‘ç«™ä¸­è·å–ä¿¡ç”¨å¡å·å’Œå¯†ç ã€‚ å°±æ˜¯è¿™æ ·ã€‚\nä¸»è¦ç½‘ç«™åœ¨å…¶ä»˜æ¬¾é¡µé¢ä¸Šè¿è¡Œæœªç»èº«ä»½éªŒè¯çš„JavaScript\nä½œä¸šä½œä¸š0 â€“ Webç¼–ç¨‹å†’é™©âœˆï¸\nåˆ†é…ï¼š9æœˆ24æ—¥ï¼Œæ˜ŸæœŸäºŒ\næˆªæ­¢æ—¶é—´ï¼š10æœˆ4æ—¥ï¼Œæ˜ŸæœŸäº”ï¼Œä¸‹åˆ5:00\nä½œä¸š1 â€“é»‘æš—ä¹‹æ—…Side\nåˆ†é…ï¼š10æœˆ8æ—¥ï¼Œæ˜ŸæœŸäºŒ\næˆªæ­¢æ—¶é—´ï¼š10æœˆ18æ—¥ï¼Œæ˜ŸæœŸäº”ï¼Œä¸‹åˆ5:00\nä½œä¸š2 â€“å“¦ï¼Œæˆ‘ä»¬ç¼–ç»‡çš„ç½‘æœ‰å¤šçº ç»“ğŸ•¸\nåˆ†é…ï¼š10æœˆ26æ—¥ï¼Œæ˜ŸæœŸå…­\næˆªæ­¢æ—¥æœŸï¼š11æœˆ7æ—¥ï¼Œæ˜ŸæœŸå››ï¼Œæ™šä¸Š11:59\nä½œä¸š3-è§å¹¿åœº\nåˆ†é…ï¼š11æœˆ12æ—¥ï¼Œæ˜ŸæœŸäºŒ\næˆªæ­¢æ—¥æœŸï¼š11æœˆ22æ—¥ï¼Œæ˜ŸæœŸäº”ï¼Œä¸‹åˆ5:00\nä½œä¸š4-è§å¹¿åœº\næŒ‡æ´¾ï¼š11æœˆ25æ—¥ï¼Œæ˜ŸæœŸä¸€\næˆªæ­¢æ—¥æœŸï¼š12æœˆ6æ—¥ï¼Œæ˜ŸæœŸäº”ï¼Œä¸‹åˆ5:00\nç½‘ç«™è®¾è®¡ç”±Feross Aboukhadijehè®¾è®¡ã€‚\n"}

{"l":"https://thoughtbot.com/blog/reading-an-explain-analyze-query-plan","n":"Reading a Postgres EXPLAIN ANALYZE Query Plan","html":"\n<nav class=\"site-nav\">\n<a class=\"site-nav-skip-link\" href=\"#main-content\">Skip to main content</a>\n<a class=\"site-nav-logo-link line-height-zero\" href=\"/blog\"><svg xmlns=\"http://www.w3.org/2000/svg\" role=\"img\" width=\"146\" height=\"35\" viewBox=\"0 0 146 35\" aria-labelledby=\"aof9gw1w01kkttj86vfkhnjhlraupbm4\" class=\"site-nav-logo\"><title id=\"aof9gw1w01kkttj86vfkhnjhlraupbm4\">Blog home</title><g><path d=\"M25.077 25.778l-.432-.43c.235-.18.387-.463.387-.78 0-.543-.44-.982-.983-.982-.544 0-.983.44-.983.98 0 .32.154.606.392.785l-.433.432c-.348-.29-.57-.785-.57-1.273 0-.392.145-.534.38-1.085h-.193v-4.96h-.277v10.557l.277.267v.75h-4.97v-.75l.67-.353h.157V25.63h-1.655v3.392l.552.267v.846l-4.695.008v-.855l.455-.337-.006-10.488h-.448v4.96h-.256c.236.55.38.692.38 1.084 0 .486-.22.95-.57 1.243l-.43-.418c.237-.18.39-.456.39-.777 0-.542-.44-.977-.98-.977-.544 0-.984.442-.984.983 0 .318.152.602.387.78l-.433.433c-.345-.292-.605-.726-.605-1.212 0-.39.34-.75.34-1.027v-7.695c0-.296.295-.533.59-.533h14.09c.297 0 .507.238.507.534v7.695c.55.276.445.635.445 1.027 0 .484-.153.92-.498 1.21zM14.05 9.094h7.183c.296 0 .582.132.582.427v4.677c0 .294-.286.685-.582.685H14.05c-.293 0-.52-.39-.52-.685V9.52c0-.294.227-.426.52-.426zm6.446-1.52l-.433.616c-.548-.525-1.437-.874-2.418-.874-.985 0-1.877.35-2.425.88l-.432-.617c.684-.616 1.71-1.006 2.857-1.006 1.143 0 2.167.388 2.85 1zm-.007-.96c-.745-.563-1.746-.872-2.818-.872-1.073 0-2.073.31-2.817.87-.176.134-.33.276-.465.427l-.436-.622C14.794 5.558 16.147 5 17.672 5c1.49 0 2.813.532 3.658 1.358l-.434.618c-.12-.128-.256-.25-.407-.363zM17.644 3.49c1.846 0 3.488.662 4.53 1.69l-.43.612c-.894-.94-2.398-1.56-4.1-1.56-1.706 0-3.214.62-4.107 1.566l-.43-.614c1.042-1.03 2.686-1.694 4.537-1.694zM17.642.077C8.022.077.225 7.857.225 17.46c0 9.598 7.798 17.38 17.417 17.38 9.62 0 17.417-7.782 17.417-17.38C35.06 7.857 27.26.076 17.64.076z\"></path><path d=\"M15.812 11.97c-.257 0-.467-.21-.467-.467 0-.26.21-.467.467-.467.26 0 .47.208.47.467 0 .258-.21.467-.47.467zm0-1.38c-.504 0-.913.41-.913.913 0 .503.408.913.912.913.505 0 .915-.41.915-.913 0-.504-.41-.913-.915-.913zM19.483 11.97c-.258 0-.467-.21-.467-.467 0-.26.21-.467.467-.467.258 0 .47.208.47.467 0 .258-.212.467-.47.467zm0-1.38c-.506 0-.916.41-.916.913 0 .503.41.913.916.913.505 0 .915-.41.915-.913 0-.504-.41-.913-.915-.913z\"></path></g><g><path d=\"M61.728 23.69h-2.406v-5.67c0-1.06-.17-1.832-.51-2.313-.34-.482-.916-.722-1.725-.722-.965 0-1.71.346-2.236 1.04v7.665h-2.405V7.765h2.406v6.116c.74-.622 1.563-.934 2.47-.934 2.94 0 4.408 1.692 4.408 5.075v5.67M63.45 18.425c0-.765.126-1.483.374-2.156s.603-1.253 1.065-1.742c.46-.488 1.02-.874 1.68-1.157.66-.282 1.395-.424 2.204-.424.81 0 1.54.142 2.193.425.653.284 1.21.673 1.672 1.17.46.494.818 1.075 1.074 1.74.256.665.383 1.38.383 2.145 0 .764-.124 1.48-.372 2.144-.25.664-.604 1.245-1.065 1.74-.46.496-1.022.885-1.682 1.168-.66.283-1.395.425-2.204.425-.823 0-1.56-.142-2.214-.425-.653-.283-1.21-.67-1.67-1.157-.463-.488-.818-1.065-1.066-1.73-.248-.665-.373-1.387-.373-2.165zm2.47 0c0 1.06.253 1.903.757 2.526.504.624 1.203.935 2.097.935.895 0 1.594-.31 2.098-.934.503-.622.755-1.464.755-2.525 0-1.062-.252-1.9-.755-2.517-.504-.615-1.203-.923-2.098-.923-.894 0-1.593.308-2.097.923-.504.616-.756 1.455-.756 2.517zM84.975 23.69H82.76l-.105-.785c-.71.665-1.555.998-2.534.998-2.866 0-4.3-1.65-4.3-4.948v-5.818h2.406v5.648c0 1.062.178 1.837.532 2.326.355.49.916.733 1.682.733.937 0 1.647-.325 2.13-.977v-7.73h2.405V23.69M91.546 29c-.824 0-1.547-.086-2.172-.256-.625-.17-1.143-.4-1.554-.69-.412-.29-.724-.623-.937-.998-.213-.375-.32-.775-.32-1.2 0-1.033.597-1.82 1.79-2.357-.668-.37-1.002-.857-1.002-1.466 0-.637.37-1.132 1.108-1.486-1.12-.78-1.682-1.918-1.682-3.42 0-.593.1-1.15.3-1.665.197-.517.48-.96.85-1.328.37-.368.82-.658 1.352-.87.532-.212 1.132-.32 1.8-.32.95 0 1.78.228 2.49.68.682-.34 1.47-.51 2.364-.51h.532l-.19 1.55h-.81c-.242 0-.512.022-.81.065.497.693.745 1.486.745 2.378 0 .566-.096 1.1-.288 1.603-.19.504-.472.946-.84 1.328-.37.382-.82.683-1.353.903-.533.22-1.133.33-1.8.33-.44 0-.852-.043-1.235-.128-.213.113-.32.255-.32.425 0 .127.047.234.14.318.09.085.244.163.457.234.213.07.5.137.862.2.362.065.82.132 1.374.202.468.07.95.163 1.447.277.497.112.95.282 1.363.508.412.227.752.524 1.022.892s.42.842.447 1.422c0 1.02-.447 1.837-1.34 2.453-.896.616-2.16.924-3.79.924zm-.47-14.228c-.68 0-1.202.213-1.564.637-.362.424-.543.997-.543 1.72 0 .72.184 1.295.553 1.72.37.424.894.636 1.576.636.68 0 1.202-.216 1.563-.647.362-.433.544-1.01.544-1.732s-.185-1.292-.554-1.71c-.37-.417-.894-.626-1.576-.626zm.576 9.534l-1.47-.212c-.453.14-.822.346-1.106.615-.284.268-.426.587-.426.955 0 .48.25.867.745 1.157.497.29 1.193.436 2.087.436.894 0 1.614-.142 2.16-.425.547-.283.82-.65.82-1.104 0-.412-.24-.72-.723-.925-.484-.205-1.18-.37-2.088-.5zM121.32 23.903c-1.092 0-2.03-.347-2.81-1.04l-.085.827h-2.235V7.765h2.406v6.094c.695-.61 1.604-.914 2.725-.914.767 0 1.463.142 2.088.425.624.284 1.156.67 1.596 1.158.44.49.78 1.07 1.022 1.74.242.674.362 1.392.362 2.157 0 .764-.117 1.48-.35 2.144-.235.664-.572 1.245-1.012 1.74-.44.496-.973.885-1.597 1.168-.626.283-1.328.425-2.11.425zm-.19-8.918c-.824 0-1.47.304-1.938.913-.47.608-.703 1.45-.703 2.527 0 1.104.233 1.957.702 2.558.468.602 1.114.902 1.937.902.85 0 1.53-.32 2.033-.966.504-.645.755-1.476.755-2.495 0-1.02-.248-1.848-.745-2.485-.496-.637-1.178-.955-2.044-.955zM107.016 23.69h-2.406v-5.67c0-1.06-.17-1.832-.51-2.313-.342-.482-.917-.722-1.726-.722-.965 0-1.71.346-2.235 1.04v7.665h-2.407V7.765h2.406v6.116c.737-.622 1.56-.934 2.47-.934 2.937 0 4.406 1.692 4.406 5.075v5.67M114.393 21.928l-.213 1.975h-1.83c-.47 0-.88-.07-1.236-.213-.355-.14-.65-.332-.884-.573-.234-.24-.408-.524-.52-.85-.115-.325-.172-.68-.172-1.06V15.09h-1.597l.214-1.953h1.384V10l2.406-.254v3.39h2.47v1.955h-2.47v5.012c0 .44.014.782.043 1.03.028.247.1.428.213.54.113.115.29.185.532.213.24.03.575.043 1 .043h.66M127.674 18.425c0-.765.124-1.483.373-2.156.248-.673.603-1.253 1.064-1.742.463-.488 1.023-.874 1.683-1.157.66-.282 1.395-.424 2.204-.424.81 0 1.54.142 2.193.425.653.284 1.21.673 1.67 1.17.463.494.82 1.075 1.077 1.74.255.665.383 1.38.383 2.145 0 .764-.124 1.48-.373 2.144-.248.664-.603 1.245-1.064 1.74-.46.496-1.022.885-1.682 1.168-.66.283-1.394.425-2.203.425-.823 0-1.56-.142-2.214-.425-.653-.283-1.21-.67-1.672-1.157-.46-.488-.815-1.065-1.063-1.73-.25-.665-.373-1.387-.373-2.165zm2.47 0c0 1.06.252 1.903.756 2.526.504.624 1.203.935 2.097.935.894 0 1.593-.31 2.097-.934.504-.622.756-1.464.756-2.525 0-1.062-.252-1.9-.756-2.517-.504-.615-1.203-.923-2.097-.923-.894 0-1.593.308-2.097.923-.504.616-.756 1.455-.756 2.517zM145.09 21.928l-.213 1.975h-1.83c-.47 0-.88-.07-1.236-.213-.354-.14-.65-.332-.883-.573-.234-.24-.408-.524-.52-.85-.115-.325-.172-.68-.172-1.06V15.09h-1.597l.213-1.953h1.385V10l2.406-.254v3.39h2.47v1.955h-2.47v5.012c0 .44.015.782.044 1.03.028.247.1.428.213.54.113.115.29.185.532.213.24.03.574.043 1 .043h.66M50.723 21.928l-.213 1.975h-1.83c-.47 0-.88-.07-1.236-.213-.355-.14-.65-.332-.884-.573-.234-.24-.408-.524-.522-.85-.113-.325-.17-.68-.17-1.06V15.09H44.27l.214-1.953h1.384V10l2.406-.254v3.39h2.47v1.955h-2.47v5.012c0 .44.014.782.043 1.03.028.247.1.428.213.54.113.115.29.185.532.213.24.03.575.043 1 .043h.66\"></path></g></svg>\n\n</a><ul class=\"site-nav-links\">\n<li>\n<a class=\"site-nav-link\" href=\"/blog/tags\">All Topics</a>\n</li>\n<li>\n<a class=\"site-nav-link\" href=\"/blog/design\">Design</a>\n</li>\n<li>\n<a class=\"site-nav-link\" href=\"/blog/web\">Web</a>\n</li>\n<li>\n<a class=\"site-nav-link\" href=\"/blog/ios\">iOS</a>\n</li>\n<li>\n<a class=\"site-nav-link\" href=\"/blog/android\">Android</a>\n</li>\n<li>\n<a class=\"site-nav-link\" href=\"/blog/search\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"512\" height=\"512\" viewBox=\"0 0 310.42 310.42\" role=\"img\" aria-labelledby=\"a6829wmpdakb4vop7qipdboxohs5o5ny\"><title id=\"a6829wmpdakb4vop7qipdboxohs5o5ny\">Search</title>\n  <path d=\"M273.587 214.965c49.11-49.11 49.11-129.02 0-178.132-49.11-49.11-129.02-49.11-178.13 0C53.793 78.497 47.483 140.463 76.51 188.85c0 0 2.085 3.498-.73 6.312-16.066 16.064-64.264 64.263-64.264 64.263-12.79 12.79-15.836 30.675-4.493 42.02l1.953 1.95c11.343 11.346 29.23 8.302 42.02-4.49l64.127-64.127c2.95-2.95 6.448-.866 6.448-.866 48.39 29.026 110.356 22.717 152.02-18.947zM118.71 191.71c-36.287-36.288-36.286-95.332.002-131.62 36.288-36.287 95.332-36.288 131.62 0 36.287 36.287 36.287 95.332 0 131.62-36.29 36.286-95.332 36.286-131.62 0z\" fill=\"#454547\"></path>\n  <path d=\"M126.75 118.424c-1.69 0-3.406-.332-5.06-1.03-6.612-2.8-9.705-10.427-6.907-17.04 17.586-41.558 65.703-61.06 107.26-43.475 6.612 2.794 9.705 10.422 6.907 17.034-2.8 6.612-10.425 9.703-17.04 6.906-28.353-11.997-61.185 1.31-73.182 29.664-2.1 4.96-6.913 7.938-11.978 7.938z\" fill=\"#454547\"></path>\n</svg>\n\n</a></li>\n</ul>\n<a class=\"hiring-cta\" onclick=\"analytics.track('Blog Hiring Button', { category: 'Click' });\" href=\"/jobs\">We're hiring!</a>\n</nav>\n\n<div class=\"container\">\n\n<article class=\"post text\" data-url=\"/blog/reading-an-explain-analyze-query-plan\" id=\"main-content\" itemscope=\"\" itemtype=\"https://schema.org/CreativeWork\" role=\"main\">\n<header>\n<h1 class=\"title\">\nReading a Postgres EXPLAIN ANALYZE Query Plan\n</h1>\n<div class=\"meta\">\n<div class=\"meta-author\">\n<a href=\"/blog/authors/caleb-hearth\">Caleb Hearth</a>\n</div>\n<time class=\"meta-date\" datetime=\"2020-03-31T21:16:07Z\" itemprop=\"dateModified\">\nJuly 26, 2016\n<span class=\"meta-updated\">updated on</span>\nMarch 31, 2020\n</time>\n<ul class=\"meta-tag-list\">\n<li class=\"meta-tag-item\">\n<a href=\"/blog/tags/postgres\">postgres</a>\n</li>\n<li class=\"meta-tag-item\">\n<a href=\"/blog/tags/performance\">performance</a>\n</li>\n<li class=\"meta-tag-item\">\n<a href=\"/blog/tags/data\">data</a>\n</li>\n<li class=\"meta-tag-item\">\n<a href=\"/blog/tags/sql\">sql</a>\n</li>\n</ul>\n\n</div>\n\n</header>\n<div class=\"post-body\">\n<p>The most powerful tool at our disposal for understanding and optimizing SQL\nqueries is <a href=\"https://www.postgresql.org/docs/9.5/static/sql-explain.html\"><code>EXPLAIN ANALYZE</code></a>, which is a Postgres command that accepts a\nstatement such as <code>SELECT ...</code>, <code>UPDATE ...</code>, or <code>DELETE ...</code>, executes the\nstatement, and instead of returning the data provides a query plan detailing\nwhat approach the planner took to executing the statement provided.</p>\n\n<p>Hereâ€™s a query pulled from the <a href=\"https://www.postgresql.org/docs/9.5/static/using-explain.html\">Postgres Using EXPLAIN page</a>:</p>\n<div class=\"highlight\"><pre class=\"highlight sql\"><code><span class=\"k\">EXPLAIN</span> <span class=\"k\">ANALYZE</span> <span class=\"k\">SELECT</span> <span class=\"o\">*</span>\n<span class=\"k\">FROM</span> <span class=\"n\">tenk1</span> <span class=\"n\">t1</span><span class=\"p\">,</span> <span class=\"n\">tenk2</span> <span class=\"n\">t2</span>\n<span class=\"k\">WHERE</span> <span class=\"n\">t1</span><span class=\"p\">.</span><span class=\"n\">unique1</span> <span class=\"o\">&lt;</span> <span class=\"mi\">100</span> <span class=\"k\">AND</span> <span class=\"n\">t1</span><span class=\"p\">.</span><span class=\"n\">unique2</span> <span class=\"o\">=</span> <span class=\"n\">t2</span><span class=\"p\">.</span><span class=\"n\">unique2</span>\n<span class=\"k\">ORDER</span> <span class=\"k\">BY</span> <span class=\"n\">t1</span><span class=\"p\">.</span><span class=\"n\">fivethous</span><span class=\"p\">;</span>\n</code></pre></div>\n<p>And the query plan it generates:</p>\n<div class=\"highlight\"><pre class=\"highlight plaintext\"><code>                                                                 QUERY PLAN\n--------------------------------------------------------------------------------------------------------------------------------------------\n Sort  (cost=717.34..717.59 rows=101 width=488) (actual time=7.761..7.774 rows=100 loops=1)\n   Sort Key: t1.fivethous\n   Sort Method: quicksort  Memory: 77kB\n   -&gt;  Hash Join  (cost=230.47..713.98 rows=101 width=488) (actual time=0.711..7.427 rows=100 loops=1)\n         Hash Cond: (t2.unique2 = t1.unique2)\n         -&gt;  Seq Scan on tenk2 t2  (cost=0.00..445.00 rows=10000 width=244) (actual time=0.007..2.583 rows=10000 loops=1)\n         -&gt;  Hash  (cost=229.20..229.20 rows=101 width=244) (actual time=0.659..0.659 rows=100 loops=1)\n               Buckets: 1024  Batches: 1  Memory Usage: 28kB\n               -&gt;  Bitmap Heap Scan on tenk1 t1  (cost=5.07..229.20 rows=101 width=244) (actual time=0.080..0.526 rows=100 loops=1)\n                     Recheck Cond: (unique1 &lt; 100)\n                     -&gt;  Bitmap Index Scan on tenk1_unique1  (cost=0.00..5.04 rows=101 width=0) (actual time=0.049..0.049 rows=100 loops=1)\n                           Index Cond: (unique1 &lt; 100)\n Planning time: 0.194 ms\n Execution time: 8.008 ms\n</code></pre></div>\n<p>Postgres builds a tree structure of plan nodes representing the different\nactions taken, with the root and each <code>-&gt;</code> pointing to one of them. In some\ncases <code>EXPLAIN ANALYZE</code> provides additional execution statistics beyond the\nexecution times and row counts, such as <code>Sort</code> and <code>Hash</code> above. Any line other\nthan the first without an <code>-&gt;</code> is such information, so the structure of the\nquery is:</p>\n<div class=\"highlight\"><pre class=\"highlight plaintext\"><code>Sort\nâ””â”€â”€ Hash Join\n    â”œâ”€â”€ Seq Scan\n    â””â”€â”€ Hash\n        â””â”€â”€ Bitmap Heap Scan\n            â””â”€â”€ Bitmap Index Scan\n</code></pre></div>\n<p>Each treeâ€™s branches represent sub-actions, and youâ€™d work inside-out to\ndetermine whatâ€™s happening â€œfirstâ€ (though the order of nodes at the same level\ncould be different).</p>\n\n<p>The first thing done is a <code>Bitmap Index Scan</code> on the <code>tenk_unique1</code> index:</p>\n<div class=\"highlight\"><pre class=\"highlight plaintext\"><code>-&gt;  Bitmap Index Scan on tenk1_unique1  (cost=0.00..5.04 rows=101 width=0) (actual time=0.049..0.049 rows=100 loops=1)\n      Index Cond: (unique1 &lt; 100)\n</code></pre></div>\n<p>This corresponds to the SQL <code>WHERE t1.unique1 &lt; 100</code>. Postgres is finding the\nlocations of the rows matching the index condition <code>unique1 &lt; 100</code>. The rows\nthemselves arenâ€™t being returned here. The cost estimate <code>(cost=0.00..5.04\nrows=101 width=0)</code> means that Postgres expects that it will â€œcostâ€ 5.04 of an <u title=\"The estimated cost is computed as (disk pages read * seq_page_cost) +\n(rows scanned * cpu_tuple_cost).\">arbitrary unit of computation</u> to find\nthese values. The 0.00 is the cost at which this node can begin working (in this\ncase, just startup time for the query). <code>rows</code> is the estimated number of rows\nthis Index Scan will return, and <code>width</code> is the estimated size in bytes of the\nreturned rows (0 because we only care about the location, not the content of the\nrows).</p>\n\n<p>Because we ran <code>EXPLAIN</code> with the <code>ANALYZE</code> option, the query was actually\nexecuted and timing information was captured. <code>(actual time=0.049..0.049\nrows=100 loops=1)</code> means that the index scan was executed 1 time (the <code>loops</code>\nvalue), that it returned 100 rows, and that the actual time was 0.. In the case\nof a node executed more than once, the actual time is an average of each\niteration and you would multiply the value by the number of loops to get real\ntime. The range values may also differ which gives an idea of min/max times\nspent. This establishes a ratio for the costs that each cost unit of <span style=\"white-space: nowrap\">0.049ms / 5.04 units â‰ˆ 0.01ms/unit</span> for this\nquery.</p>\n\n<p>The results of the Index Scan are passed up to a <code>Bitmap Heap Scan</code> action. In\nthis node, Postgres is taking the locations of the rows in the tenk1 table,\naliased as t1, where <code>unique1 &lt; 100</code> and fetching the rows from the table\nitself.</p>\n<div class=\"highlight\"><pre class=\"highlight plaintext\"><code>-&gt;  Bitmap Heap Scan on tenk1 t1  (cost=5.07..229.20 rows=101 width=244) (actual time=0.080..0.526 rows=100 loops=1)\n      Recheck Cond: (unique1 &lt; 100)\n</code></pre></div>\n<p>We can see that the cost expectations, when multiplied by the 0.01 value we\ncalculated, would mean a rough expected time of <span style=\"white-space:\nnowrap\">(229.20 - 5.07) * 0.01 â‰ˆ 2.24ms</span>, and we see an actual time of\n0.526ms per row, which is off by a factor of 4. This may be because the cost\nestimate is an upper bound and not all rows needed to be read, or because the\nrecheck condition is always true.</p>\n\n<p>The combination of <code>Bitmap Index Scan</code> and <code>Bitmap Heap Scan</code> is much more\nexpensive than reading the rows sequentially from the table (a <code>Seq Scan</code>), but\nbecause relatively few rows need to be visited in this case the two step process\nends up being faster. This is further sped by sorting the rows into physical\norder before fetching them, which minimizes the cost of separate fetches. The\nâ€œbitmapâ€ in the node names does the sorting.</p>\n\n<p>The results of the heap scan, those rows from tenk1 for which <code>unique1 &lt; 100</code> is\ntrue, are inserted into an in-memory Hash table as they are read. As we can see\nby the costs, this takes no time at all.</p>\n<div class=\"highlight\"><pre class=\"highlight plaintext\"><code>-&gt;  Hash  (cost=229.20..229.20 rows=101 width=244) (actual time=0.659..0.659 rows=100 loops=1)\n      Buckets: 1024  Batches: 1  Memory Usage: 28kB\n</code></pre></div>\n<p>The Hash node includes information about number of hash buckets and batches, as\nwell as peak memory usage. If Batches &gt; 1 thereâ€™s also disk usage involved, but\nthat is not shown. The memory usage makes sense at <span style=\"white-space:\nnowrap\">100 rows * 244 bytes = 24.4 kB</span>, which is close enough to the\n28kB for our purposes that we can assume itâ€™s the memory taken by the Hash keys\nthemselves.</p>\n\n<p>Next, Postgres reads all 10000 rows from tenk2 (aliased as t2) and checks them\nagainst the Hash of tenk1 rows. Hash Join means that the rows of one table are\nentered into an in-memory hash (which weâ€™ve built up to so far), after which the\nrows of another table is scanned and its values probed against the hash table\nfor matches. We see the conditions of the â€œmatchâ€ on the second line, <code>Hash\nCond: (t2.unique2 = t1.unique2)</code>. Note that because the query is selecting all\nvalues from both tenk1 and tenk2, the width of each row doubles during the Hash\nJoin.</p>\n<div class=\"highlight\"><pre class=\"highlight plaintext\"><code>-&gt;  Hash Join  (cost=230.47..713.98 rows=101 width=488) (actual time=0.711..7.427 rows=100 loops=1)\n      Hash Cond: (t2.unique2 = t1.unique2)\n      -&gt;  Seq Scan on tenk2 t2  (cost=0.00..445.00 rows=10000 width=244) (actual time=0.007..2.583 rows=10000 loops=1)\n</code></pre></div>\n<p>Now that all rows that meet our conditions have been collected, we can sort the\nresult set by the <code>Sort Key: t1.fivethous</code>.</p>\n<div class=\"highlight\"><pre class=\"highlight plaintext\"><code>Sort  (cost=717.34..717.59 rows=101 width=488) (actual time=7.761..7.774 rows=100 loops=1)\n  Sort Key: t1.fivethous\n  Sort Method: quicksort  Memory: 77kB\n</code></pre></div>\n<p>The Sort node includes information about the algorithm used to sort,\n<code>quicksort</code>, whether the sort was done in memory or on disk (which greatly\neffects speed), and the amount of memory/disk space needed.</p>\n\n<p>Understanding how to read query plans is great for optimizing queries. For\nexample, Seq Scan nodes often indicate an opportunity for an index to be added,\nwhich is much faster to read. Familiarizing yourself with these plans will make\nyou a better database engineer. For more examples of query plans, read <a href=\"https://www.postgresql.org/docs/9.5/static/using-explain.html\">Using\n<code>EXPLAIN</code></a> from which this example was taken.</p>\n\n<p>Now that youâ€™re able to read a query plan, <a href=\"https://thoughtbot.com/blog/advanced-postgres-performance-tips\" title=\"Advanced Postgres Performance Tips\">learn to optimize performance</a>.</p>\n\n</div>\n<aside class=\"related-articles\">\n<h2>If you enjoyed this post, you might also like:</h2>\n<ol>\n<li>\n<a href=\"/blog/ordering-within-a-sql-group-by-clause\">Finding the Oldest/Youngest Records Within a Group</a>\n</li>\n<li>\n<a href=\"/blog/postgresql-performance-considerations\">PostgreSQL Performance Considerations</a>\n</li>\n<li>\n<a href=\"/blog/postgres-index-types\">Postgres Index Types</a>\n</li>\n</ol>\n</aside>\n</article>\n\n</div>\n<section class=\"container\">\n<div id=\"promoted\">\n<div class=\"ads\">\n<img alt=\"Developer working on a Code Audit at their desk\" class=\"ads__image\" src=\"https://thoughtbot.com/blog/assets/article-ads/code-audit-29b1862f214a72e74c82707e6f8d765b62c59c735d8f2135f768729c4b9360ea.jpg\">\n<div class=\"ads__body\">\n<h3 class=\"ads__title\">\nUpgrade your codebase with a Code Audit\n</h3>\n<p>\nLearn how we can help you understand the current state of your code\nquality, speed up delivery times, improve developer happiness, and level\nup your user experience\n</p>\n<a class=\"button\" href=\"https://thoughtbot.com/services/code-audit\">Learn more about a Code Audit</a>\n</div>\n</div>\n\n\n</div>\n\n</section>\n<div class=\"global-footer\">\n<div class=\"container container-wide\">\n<nav class=\"global-footer-link-section\">\n<ul class=\"global-footer-link-list\">\n<li>\n<a href=\"https://thoughtbot.com/services\">Services\n</a></li>\n<li>\n<a href=\"https://thoughtbot.com/case-studies\">Case Studies\n</a></li>\n<li>\n<a href=\"https://thoughtbot.com/resources\">Resources\n</a></li>\n<li>\n<a href=\"https://thoughtbot.com/hire-us\">Hire Us\n</a></li>\n</ul>\n<ul class=\"global-footer-link-list\">\n<li>\n<a href=\"https://thoughtbot.com/our-company\">Our Company\n</a></li>\n<li>\n<a href=\"https://thoughtbot.com/purpose\">Purpose\n</a></li>\n<li>\n<a href=\"https://thoughtbot.com/blog\">Blog\n</a></li>\n<li>\n<a href=\"https://thoughtbot.com/jobs\">Join our team\n</a></li>\n</ul>\n<ul class=\"global-footer-link-list\">\n<li>\n<a href=\"https://twitter.com/thoughtbot\">Twitter\n</a></li>\n<li>\n<a href=\"https://github.com/thoughtbot\">GitHub\n</a></li>\n<li>\n<a href=\"https://dribbble.com/thoughtbot\">Dribbble\n</a></li>\n<li>\n<a href=\"https://www.instagram.com/thoughtbot/\">Instagram\n</a></li>\n</ul>\n</nav>\n<footer class=\"global-footer-copywright-section\">\n<p class=\"global-footer-copywright-prose\">\nÂ© 2020\n<a href=\"https://thoughtbot.com\">thoughtbot, inc.</a>\nThe design of a robot and thoughtbot are registered trademarks of\nthoughtbot, inc.\n<a href=\"//www.iubenda.com/privacy-policy/7827608\">Privacy Policy</a>\n</p>\n</footer>\n</div>\n</div>\n\n\n  <script type=\"text/javascript\" async=\"\" src=\"https://js.hs-analytics.net/analytics/1587651000000/5257758.js\" id=\"hs-analytics\"></script><script type=\"text/javascript\" async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://cdn.segment.com/analytics.js/v1/wperrhev8f/analytics.min.js\"></script><script>\n    !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error(\"Segment snippet included twice.\");else{analytics.invoked=!0;analytics.methods=[\"trackSubmit\",\"trackClick\",\"trackLink\",\"trackForm\",\"pageview\",\"identify\",\"reset\",\"group\",\"track\",\"ready\",\"alias\",\"debug\",\"page\",\"once\",\"off\",\"on\"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement(\"script\");e.type=\"text/javascript\";e.async=!0;e.src=(\"https:\"===document.location.protocol?\"https://\":\"http://\")+\"cdn.segment.com/analytics.js/v1/\"+t+\"/analytics.min.js\";var n=document.getElementsByTagName(\"script\")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION=\"4.0.0\";\n    analytics.load(\"wperrhev8f\");\n    analytics.page();\n    }}();\n  </script>\n\n\n\n\n","text":"Skip to main content Blog home\nAll Topics\nDesign\nWeb\niOS\nAndroid\nSearch\nWe're hiring!\nReading a Postgres EXPLAIN ANALYZE Query Plan\nCaleb Hearth\nJuly 26, 2016\nupdated on\nMarch 31, 2020\npostgres\nperformance\ndata\nsql\nThe most powerful tool at our disposal for understanding and optimizing SQL\nqueries is EXPLAIN ANALYZE, which is a Postgres command that accepts a\nstatement such as SELECT ..., UPDATE ..., or DELETE ..., executes the\nstatement, and instead of returning the data provides a query plan detailing\nwhat approach the planner took to executing the statement provided.\nHereâ€™s a query pulled from the Postgres Using EXPLAIN page:\n<code><span class=\"k\">EXPLAIN</span> <span class=\"k\">ANALYZE</span> <span class=\"k\">SELECT</span> <span class=\"o\">*</span>\n<span class=\"k\">FROM</span> <span class=\"n\">tenk1</span> <span class=\"n\">t1</span><span class=\"p\">,</span> <span class=\"n\">tenk2</span> <span class=\"n\">t2</span>\n<span class=\"k\">WHERE</span> <span class=\"n\">t1</span><span class=\"p\">.</span><span class=\"n\">unique1</span> <span class=\"o\">&lt;</span> <span class=\"mi\">100</span> <span class=\"k\">AND</span> <span class=\"n\">t1</span><span class=\"p\">.</span><span class=\"n\">unique2</span> <span class=\"o\">=</span> <span class=\"n\">t2</span><span class=\"p\">.</span><span class=\"n\">unique2</span>\n<span class=\"k\">ORDER</span> <span class=\"k\">BY</span> <span class=\"n\">t1</span><span class=\"p\">.</span><span class=\"n\">fivethous</span><span class=\"p\">;</span>\n</code>\nAnd the query plan it generates:\n<code> QUERY PLAN\n-------------------------------------------------------------------------------------------------------------------------------------------- Sort (cost=717.34..717.59 rows=101 width=488) (actual time=7.761..7.774 rows=100 loops=1) Sort Key: t1.fivethous Sort Method: quicksort Memory: 77kB -&gt; Hash Join (cost=230.47..713.98 rows=101 width=488) (actual time=0.711..7.427 rows=100 loops=1) Hash Cond: (t2.unique2 = t1.unique2) -&gt; Seq Scan on tenk2 t2 (cost=0.00..445.00 rows=10000 width=244) (actual time=0.007..2.583 rows=10000 loops=1) -&gt; Hash (cost=229.20..229.20 rows=101 width=244) (actual time=0.659..0.659 rows=100 loops=1) Buckets: 1024 Batches: 1 Memory Usage: 28kB -&gt; Bitmap Heap Scan on tenk1 t1 (cost=5.07..229.20 rows=101 width=244) (actual time=0.080..0.526 rows=100 loops=1) Recheck Cond: (unique1 &lt; 100) -&gt; Bitmap Index Scan on tenk1_unique1 (cost=0.00..5.04 rows=101 width=0) (actual time=0.049..0.049 rows=100 loops=1) Index Cond: (unique1 &lt; 100) Planning time: 0.194 ms Execution time: 8.008 ms\n</code>\nPostgres builds a tree structure of plan nodes representing the different\nactions taken, with the root and each -&gt; pointing to one of them. In some\ncases EXPLAIN ANALYZE provides additional execution statistics beyond the\nexecution times and row counts, such as Sort and Hash above. Any line other\nthan the first without an -&gt; is such information, so the structure of the\nquery is:\n<code>Sort\nâ””â”€â”€ Hash Join â”œâ”€â”€ Seq Scan â””â”€â”€ Hash â””â”€â”€ Bitmap Heap Scan â””â”€â”€ Bitmap Index Scan\n</code>\nEach treeâ€™s branches represent sub-actions, and youâ€™d work inside-out to\ndetermine whatâ€™s happening â€œfirstâ€ (though the order of nodes at the same level\ncould be different).\nThe first thing done is a Bitmap Index Scan on the tenk_unique1 index:\n<code>-&gt; Bitmap Index Scan on tenk1_unique1 (cost=0.00..5.04 rows=101 width=0) (actual time=0.049..0.049 rows=100 loops=1) Index Cond: (unique1 &lt; 100)\n</code>\nThis corresponds to the SQL WHERE t1.unique1 &lt; 100. Postgres is finding the\nlocations of the rows matching the index condition unique1 &lt; 100. The rows\nthemselves arenâ€™t being returned here. The cost estimate (cost=0.00..5.04\nrows=101 width=0) means that Postgres expects that it will â€œcostâ€ 5.04 of an arbitrary unit of computation to find\nthese values. The 0.00 is the cost at which this node can begin working (in this\ncase, just startup time for the query). rows is the estimated number of rows\nthis Index Scan will return, and width is the estimated size in bytes of the\nreturned rows (0 because we only care about the location, not the content of the\nrows).\nBecause we ran EXPLAIN with the ANALYZE option, the query was actually\nexecuted and timing information was captured. (actual time=0.049..0.049\nrows=100 loops=1) means that the index scan was executed 1 time (the loops\nvalue), that it returned 100 rows, and that the actual time was 0.. In the case\nof a node executed more than once, the actual time is an average of each\niteration and you would multiply the value by the number of loops to get real\ntime. The range values may also differ which gives an idea of min/max times\nspent. This establishes a ratio for the costs that each cost unit of 0.049ms / 5.04 units â‰ˆ 0.01ms/unit for this\nquery.\nThe results of the Index Scan are passed up to a Bitmap Heap Scan action. In\nthis node, Postgres is taking the locations of the rows in the tenk1 table,\naliased as t1, where unique1 &lt; 100 and fetching the rows from the table\nitself.\n<code>-&gt; Bitmap Heap Scan on tenk1 t1 (cost=5.07..229.20 rows=101 width=244) (actual time=0.080..0.526 rows=100 loops=1) Recheck Cond: (unique1 &lt; 100)\n</code>\nWe can see that the cost expectations, when multiplied by the 0.01 value we\ncalculated, would mean a rough expected time of (229.20 - 5.07) * 0.01 â‰ˆ 2.24ms, and we see an actual time of\n0.526ms per row, which is off by a factor of 4. This may be because the cost\nestimate is an upper bound and not all rows needed to be read, or because the\nrecheck condition is always true.\nThe combination of Bitmap Index Scan and Bitmap Heap Scan is much more\nexpensive than reading the rows sequentially from the table (a Seq Scan), but\nbecause relatively few rows need to be visited in this case the two step process\nends up being faster. This is further sped by sorting the rows into physical\norder before fetching them, which minimizes the cost of separate fetches. The\nâ€œbitmapâ€ in the node names does the sorting.\nThe results of the heap scan, those rows from tenk1 for which unique1 &lt; 100 is\ntrue, are inserted into an in-memory Hash table as they are read. As we can see\nby the costs, this takes no time at all.\n<code>-&gt; Hash (cost=229.20..229.20 rows=101 width=244) (actual time=0.659..0.659 rows=100 loops=1) Buckets: 1024 Batches: 1 Memory Usage: 28kB\n</code>\nThe Hash node includes information about number of hash buckets and batches, as\nwell as peak memory usage. If Batches &gt; 1 thereâ€™s also disk usage involved, but\nthat is not shown. The memory usage makes sense at 100 rows * 244 bytes = 24.4 kB, which is close enough to the\n28kB for our purposes that we can assume itâ€™s the memory taken by the Hash keys\nthemselves.\nNext, Postgres reads all 10000 rows from tenk2 (aliased as t2) and checks them\nagainst the Hash of tenk1 rows. Hash Join means that the rows of one table are\nentered into an in-memory hash (which weâ€™ve built up to so far), after which the\nrows of another table is scanned and its values probed against the hash table\nfor matches. We see the conditions of the â€œmatchâ€ on the second line, Hash\nCond: (t2.unique2 = t1.unique2). Note that because the query is selecting all\nvalues from both tenk1 and tenk2, the width of each row doubles during the Hash\nJoin.\n<code>-&gt; Hash Join (cost=230.47..713.98 rows=101 width=488) (actual time=0.711..7.427 rows=100 loops=1) Hash Cond: (t2.unique2 = t1.unique2) -&gt; Seq Scan on tenk2 t2 (cost=0.00..445.00 rows=10000 width=244) (actual time=0.007..2.583 rows=10000 loops=1)\n</code>\nNow that all rows that meet our conditions have been collected, we can sort the\nresult set by the Sort Key: t1.fivethous.\n<code>Sort (cost=717.34..717.59 rows=101 width=488) (actual time=7.761..7.774 rows=100 loops=1) Sort Key: t1.fivethous Sort Method: quicksort Memory: 77kB\n</code>\nThe Sort node includes information about the algorithm used to sort,\nquicksort, whether the sort was done in memory or on disk (which greatly\neffects speed), and the amount of memory/disk space needed.\nUnderstanding how to read query plans is great for optimizing queries. For\nexample, Seq Scan nodes often indicate an opportunity for an index to be added,\nwhich is much faster to read. Familiarizing yourself with these plans will make\nyou a better database engineer. For more examples of query plans, read Using\nEXPLAIN from which this example was taken.\nNow that youâ€™re able to read a query plan, learn to optimize performance.\nIf you enjoyed this post, you might also like:\nFinding the Oldest/Youngest Records Within a Group\nPostgreSQL Performance Considerations\nPostgres Index Types\nUpgrade your codebase with a Code Audit\nLearn how we can help you understand the current state of your code\nquality, speed up delivery times, improve developer happiness, and level\nup your user experience\nLearn more about a Code Audit\nServices\nCase Studies\nResources\nHire Us\nOur Company\nPurpose\nBlog\nJoin our team\nTwitter\nGitHub\nDribbble\nInstagram\nÂ© 2020\nthoughtbot, inc.\nThe design of a robot and thoughtbot are registered trademarks of\nthoughtbot, inc.\nPrivacy Policy","ctext":"è·³åˆ°ä¸»è¦å†…å®¹åšå®¢ä¸»é¡µ\nå…¨éƒ¨è¯é¢˜\nè®¾è®¡\nç½‘é¡µ\nçš„iOS\nå®‰å“ç³»ç»Ÿ\næœç´¢\næˆ‘ä»¬æ­£åœ¨æ‹›è˜ï¼\né˜…è¯»Postgres EXPLAIN ANALYZEæŸ¥è¯¢è®¡åˆ’\nè¿¦å‹’Â·å£ç‚‰æ–¯\n2016å¹´7æœˆ26æ—¥\næ›´æ–°äº\n2020å¹´3æœˆ31æ—¥\nPostgresçš„\næ€§èƒ½\næ•°æ®\nsql\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„åŠŸèƒ½æœ€å¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºäº†è§£å’Œä¼˜åŒ–SQL\næŸ¥è¯¢æ˜¯EXPLAIN ANALYZEï¼Œå®ƒæ˜¯ä¸€ä¸ªPostgreså‘½ä»¤ï¼Œæ¥å—ä¸€ä¸ª\nè¯¸å¦‚SELECT ...ï¼ŒUPDATE ...æˆ–DELETE ...ä¹‹ç±»çš„è¯­å¥æ‰§è¡Œ\nè¯­å¥ï¼Œè€Œä¸æ˜¯è¿”å›æ•°æ®ï¼Œè€Œæ˜¯æä¾›æŸ¥è¯¢è®¡åˆ’è¯¦ç»†ä¿¡æ¯\nè®¡åˆ’è€…é‡‡ç”¨ä½•ç§æ–¹å¼æ‰§è¡Œæ‰€æä¾›çš„è¯­å¥ã€‚\nè¿™æ˜¯ä»Postgresä½¿ç”¨è¯´æ˜é¡µé¢æå–çš„æŸ¥è¯¢ï¼š\n<code><span class=\"k\">EXPLAIN</span> <span class=\"k\">ANALYZE</span> <span class=\"k\">SELECT</span> <span class=\"o\">*</span>\n<span class=\"k\">FROM</span> <span class=\"n\">tenk1</span> <span class=\"n\">t1</span><span class=\"p\">,</span> <span class=\"n\">tenk2</span> <span class=\"n\">t2</span>\n<span class=\"k\">WHERE</span> <span class=\"n\">t1</span><span class=\"p\">.</span><span class=\"n\">unique1</span> <span class=\"o\">&lt;</span> <span class=\"mi\">100</span> <span class=\"k\">AND</span> <span class=\"n\">t1</span><span class=\"p\">.</span><span class=\"n\">unique2</span> <span class=\"o\">=</span> <span class=\"n\">t2</span><span class=\"p\">.</span><span class=\"n\">unique2</span>\n<span class=\"k\">ORDER</span> <span class=\"k\">BY</span> <span class=\"n\">t1</span><span class=\"p\">.</span><span class=\"n\">fivethous</span><span class=\"p\">;</span>\n</code>\nå¹¶ç”ŸæˆæŸ¥è¯¢è®¡åˆ’ï¼š\n<code> QUERY PLAN\n-------------------------------------------------------------------------------------------------------------------------------------------- Sort (cost=717.34..717.59 rows=101 width=488) (actual time=7.761..7.774 rows=100 loops=1) Sort Key: t1.fivethous Sort Method: quicksort Memory: 77kB -&gt; Hash Join (cost=230.47..713.98 rows=101 width=488) (actual time=0.711..7.427 rows=100 loops=1) Hash Cond: (t2.unique2 = t1.unique2) -&gt; Seq Scan on tenk2 t2 (cost=0.00..445.00 rows=10000 width=244) (actual time=0.007..2.583 rows=10000 loops=1) -&gt; Hash (cost=229.20..229.20 rows=101 width=244) (actual time=0.659..0.659 rows=100 loops=1) Buckets: 1024 Batches: 1 Memory Usage: 28kB -&gt; Bitmap Heap Scan on tenk1 t1 (cost=5.07..229.20 rows=101 width=244) (actual time=0.080..0.526 rows=100 loops=1) Recheck Cond: (unique1 &lt; 100) -&gt; Bitmap Index Scan on tenk1_unique1 (cost=0.00..5.04 rows=101 width=0) (actual time=0.049..0.049 rows=100 loops=1) Index Cond: (unique1 &lt; 100) Planning time: 0.194 ms Execution time: 8.008 ms\n</code>\nPostgresæ„å»ºè¡¨ç¤ºä¸åŒèŠ‚ç‚¹çš„è®¡åˆ’èŠ‚ç‚¹çš„æ ‘å½¢ç»“æ„\nPostgresæ„å»ºè¡¨ç¤ºä¸åŒèŠ‚ç‚¹çš„è®¡åˆ’èŠ‚ç‚¹çš„æ ‘å½¢ç»“æ„...\nåœ¨EXPLAIN ANALYZEçš„æƒ…å†µä¸‹ï¼Œé™¤äº†\næ‰§è¡Œæ—¶é—´å’Œè¡Œè®¡æ•°ï¼Œä¾‹å¦‚ä¸Šé¢çš„Sortå’ŒHashã€‚ å…¶ä»–ä»»ä½•è¡Œ\næ‰§è¡Œæ—¶é—´å’Œè¡Œè®¡æ•°ï¼Œä¾‹å¦‚ä¸Šé¢çš„Sortå’ŒHashã€‚ å…¶ä»–ä»»ä½•è¡Œ...\næŸ¥è¯¢æ˜¯ï¼š\n<code>Sort\nâ””â”€â”€ Hash Join â”œâ”€â”€ Seq Scan â””â”€â”€ Hash â””â”€â”€ Bitmap Heap Scan â””â”€â”€ Bitmap Index Scan\n</code>\næ¯æ£µæ ‘çš„åˆ†æ”¯ä»£è¡¨å­æ“ä½œï¼Œæ‚¨å¯ä»¥ç”±å†…è€Œå¤–åœ°\nç¡®å®šâ€œç¬¬ä¸€â€å‘ç”Ÿäº†ä»€ä¹ˆï¼ˆå°½ç®¡èŠ‚ç‚¹åœ¨åŒä¸€çº§åˆ«çš„é¡ºåº\nå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼‰ã€‚\né¦–å…ˆè¦åšçš„æ˜¯å¯¹tenk_unique1ç´¢å¼•è¿›è¡Œä½å›¾ç´¢å¼•æ‰«æï¼š\n<code>-&gt; Bitmap Index Scan on tenk1_unique1 (cost=0.00..5.04 rows=101 width=0) (actual time=0.049..0.049 rows=100 loops=1) Index Cond: (unique1 &lt; 100)\n</code>\né¦–å…ˆè¦åšçš„æ˜¯å¯¹tenk_unique1ç´¢å¼•è¿›è¡Œä½å›¾ç´¢å¼•æ‰«æï¼š...\né¦–å…ˆè¦åšçš„æ˜¯å¯¹tenk_unique1ç´¢å¼•è¿›è¡Œä½å›¾ç´¢å¼•æ‰«æï¼š......\nè‡ªå·±ä¸ä¼šè¿”å›è¿™é‡Œã€‚ è´¹ç”¨ä¼°ç®—ï¼ˆè´¹ç”¨= 0.00..5.04\nrows = 101 width = 0ï¼‰æ„å‘³ç€PostgresæœŸæœ›â€œèŠ±è´¹â€ 5.04çš„ä»»æ„è®¡ç®—å•ä½æ¥æŸ¥æ‰¾\nè¿™äº›å€¼ã€‚ 0.00æ˜¯è¯¥èŠ‚ç‚¹å¯ä»¥å¼€å§‹å·¥ä½œçš„æˆæœ¬ï¼ˆåœ¨æ­¤æƒ…å†µä¸‹ï¼Œ\næƒ…å†µä¸‹ï¼Œåªéœ€æŸ¥è¯¢çš„å¯åŠ¨æ—¶é—´å³å¯ï¼‰ã€‚ è¡Œæ˜¯ä¼°è®¡çš„è¡Œæ•°\næ­¤ç´¢å¼•æ‰«æå°†è¿”å›ï¼Œå¹¶ä¸”widthæ˜¯ä¼°è®¡çš„å­—èŠ‚å¤§å°\nè¿”å›çš„è¡Œï¼ˆ0ï¼Œå› ä¸ºæˆ‘ä»¬åªå…³å¿ƒä½ç½®ï¼Œè€Œä¸å…³å¿ƒ\nè¡Œï¼‰ã€‚\nå› ä¸ºæˆ‘ä»¬ä½¿ç”¨ANALYZEé€‰é¡¹è¿è¡ŒEXPLAINï¼Œæ‰€ä»¥æŸ¥è¯¢å®é™…ä¸Šæ˜¯\næ‰§è¡Œå¹¶æ•è·å®šæ—¶ä¿¡æ¯ã€‚ ï¼ˆå®é™…æ—¶é—´= 0.049..0.049\nrows = 100 loops = 1ï¼‰è¡¨ç¤ºç´¢å¼•æ‰«æå·²æ‰§è¡Œ1æ¬¡ï¼ˆå¾ªç¯\nå€¼ï¼‰ï¼Œåˆ™è¿”å›100è¡Œï¼Œè€Œå®é™…æ—¶é—´ä¸º0ã€‚\nä¸€ä¸ªèŠ‚ç‚¹è¢«å¤šæ¬¡æ‰§è¡Œçš„æ—¶é—´ï¼Œå®é™…æ—¶é—´æ˜¯æ¯ä¸ªèŠ‚ç‚¹çš„å¹³å‡å€¼\nè¿­ä»£ï¼Œæ‚¨å¯ä»¥å°†å€¼ä¹˜ä»¥å¾ªç¯æ•°ä»¥è·å¾—å®æ•°\næ—¶é—´ã€‚ èŒƒå›´å€¼ä¹Ÿå¯èƒ½æœ‰æ‰€ä¸åŒï¼Œè¿™ç»™å‡ºäº†æœ€å°/æœ€å¤§æ—¶é—´çš„æ¦‚å¿µ\nèŠ±è´¹ã€‚ è¿™æ ·å°±ç¡®å®šäº†æˆæœ¬æ¯”ç‡ï¼Œä¸ºæ­¤ï¼Œæ¯ä¸ªæˆæœ¬å•ä½ä¸º0.049ms / 5.04å•ä½â‰ˆ0.01ms /å•ä½\næŸ¥è¯¢ã€‚\nç´¢å¼•æ‰«æçš„ç»“æœå°†ä¼ é€’åˆ°ä½å›¾å †æ‰«ææ“ä½œã€‚ åœ¨\nåœ¨è¿™ä¸ªèŠ‚ç‚¹ä¸Šï¼ŒPostgresæ­£åœ¨è·å–tenk1è¡¨ä¸­çš„è¡Œçš„ä½ç½®ï¼Œ\nåœ¨è¿™ä¸ªèŠ‚ç‚¹ä¸Šï¼ŒPostgresæ­£åœ¨è·å–tenk1è¡¨ä¸­çš„è¡Œçš„ä½ç½®ï¼Œ...\næœ¬èº«ã€‚\n<code>-&gt; Bitmap Heap Scan on tenk1 t1 (cost=5.07..229.20 rows=101 width=244) (actual time=0.080..0.526 rows=100 loops=1) Recheck Cond: (unique1 &lt; 100)\n</code>\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå°†æˆæœ¬é¢„æœŸå€¼ä¹˜ä»¥0.01å€¼åï¼Œ\nè®¡ç®—å¾—å‡ºï¼Œè¿™æ„å‘³ç€ï¼ˆ229.20-5.07ï¼‰* 0.01â‰ˆ2.24msçš„å¤§è‡´é¢„æœŸæ—¶é—´ï¼Œè€Œæˆ‘ä»¬çœ‹åˆ°çš„å®é™…æ—¶é—´ä¸º\næ¯è¡Œ0.526msï¼Œç›¸å·®4å€ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºæˆæœ¬\nä¼°è®¡å€¼æ˜¯ä¸€ä¸ªä¸Šé™ï¼Œå¹¶éæ‰€æœ‰è¡Œéƒ½éœ€è¦è¯»å–ï¼Œæˆ–è€…å› ä¸º\né‡æ–°æ£€æŸ¥æ¡ä»¶å§‹ç»ˆä¸ºçœŸã€‚\nä½å›¾ç´¢å¼•æ‰«æå’Œä½å›¾å †æ‰«æçš„ç»“åˆæ›´å¤š\næ¯”ä»è¡¨ä¸­é¡ºåºè¯»å–è¡Œï¼ˆSeqæ‰«æï¼‰è¦æ˜‚è´µï¼Œä½†æ˜¯\nå› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ä¸¤æ­¥è¿‡ç¨‹éœ€è¦è®¿é—®çš„è¡Œç›¸å¯¹è¾ƒå°‘\næœ€ç»ˆå˜å¾—æ›´å¿«ã€‚ é€šè¿‡å°†è¡Œåˆ†ç±»ä¸ºç‰©ç†è¡Œå¯ä»¥è¿›ä¸€æ­¥åŠ é€Ÿ\nåœ¨æå–å®ƒä»¬ä¹‹å‰å…ˆè¿›è¡Œè®¢è´­ï¼Œè¿™æ ·å¯ä»¥æœ€å¤§ç¨‹åº¦åœ°å‡å°‘å•ç‹¬æå–çš„æˆæœ¬ã€‚ çš„\nèŠ‚ç‚¹åç§°ä¸­çš„â€œä½å›¾â€è¿›è¡Œæ’åºã€‚\nèŠ‚ç‚¹åç§°ä¸­çš„â€œä½å›¾â€è¿›è¡Œæ’åºã€‚...\ntrueï¼Œå°†åœ¨è¯»å–æ—¶æ’å…¥åˆ°å†…å­˜ä¸­çš„å“ˆå¸Œè¡¨ä¸­ã€‚ å¦‚æˆ‘ä»¬æ‰€è§\nä»æˆæœ¬ä¸Šæ¥è¯´ï¼Œè¿™æ ¹æœ¬ä¸éœ€è¦æ—¶é—´ã€‚\n<code>-&gt; Hash (cost=229.20..229.20 rows=101 width=244) (actual time=0.659..0.659 rows=100 loops=1) Buckets: 1024 Batches: 1 Memory Usage: 28kB\n</code>\nå“ˆå¸ŒèŠ‚ç‚¹åŒ…å«æœ‰å…³å“ˆå¸Œæ¡¶å’Œæ‰¹æ¬¡æ•°é‡çš„ä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤º\nå“ˆå¸ŒèŠ‚ç‚¹åŒ…å«æœ‰å…³å“ˆå¸Œæ¡¶å’Œæ‰¹æ¬¡æ•°é‡çš„ä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤º...\næ²¡æœ‰æ˜¾ç¤ºã€‚ å†…å­˜ä½¿ç”¨é‡åœ¨100è¡Œ* 244å­—èŠ‚= 24.4 kBæ—¶æ‰æœ‰æ„ä¹‰ï¼Œè¶³å¤Ÿæ¥è¿‘\nå‡ºäºæˆ‘ä»¬çš„ç›®çš„ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾å®ƒæ˜¯28kBï¼Œæ˜¯å“ˆå¸Œé”®å ç”¨çš„å†…å­˜\nä»–ä»¬è‡ªå·±ã€‚\næ¥ä¸‹æ¥ï¼ŒPostgresä»tenk2ä¸­è¯»å–æ‰€æœ‰10000è¡Œï¼ˆåˆ«åä¸ºt2ï¼‰å¹¶è¿›è¡Œæ£€æŸ¥\né’ˆå¯¹tenk1è¡Œçš„å“ˆå¸Œå€¼ã€‚ å“ˆå¸Œè”æ¥æ„å‘³ç€ä¸€ä¸ªè¡¨çš„è¡Œæ˜¯\nè¾“å…¥åˆ°å†…å­˜ä¸­çš„å“ˆå¸Œï¼ˆåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å»ºç«‹äº†ï¼‰ï¼Œç„¶å\næ‰«æå¦ä¸€ä¸ªè¡¨çš„è¡Œï¼Œå¹¶é’ˆå¯¹å“ˆå¸Œè¡¨æ¢æŸ¥å…¶å€¼\næ¯”èµ›ã€‚ æˆ‘ä»¬åœ¨ç¬¬äºŒè¡Œâ€œå“ˆå¸Œâ€ä¸­çœ‹åˆ°â€œåŒ¹é…â€çš„æ¡ä»¶\næ¡ä»¶ï¼šï¼ˆt2.unique2 = t1.unique2ï¼‰ã€‚ è¯·æ³¨æ„ï¼Œå› ä¸ºæŸ¥è¯¢æ­£åœ¨é€‰æ‹©å…¨éƒ¨\næ¥è‡ªtenk1å’Œtenk2çš„å€¼ï¼Œåœ¨HashæœŸé—´æ¯ä¸€è¡Œçš„å®½åº¦åŠ å€\nåŠ å…¥ã€‚\n<code>-&gt; Hash Join (cost=230.47..713.98 rows=101 width=488) (actual time=0.711..7.427 rows=100 loops=1) Hash Cond: (t2.unique2 = t1.unique2) -&gt; Seq Scan on tenk2 t2 (cost=0.00..445.00 rows=10000 width=244) (actual time=0.007..2.583 rows=10000 loops=1)\n</code>\nç°åœ¨ï¼Œå·²ç»æ”¶é›†äº†æ‰€æœ‰ç¬¦åˆæˆ‘ä»¬æ¡ä»¶çš„è¡Œï¼Œæˆ‘ä»¬å¯ä»¥å¯¹\né€šè¿‡æ’åºé”®è®¾ç½®çš„ç»“æœï¼št1.fivethousã€‚\n<code>Sort (cost=717.34..717.59 rows=101 width=488) (actual time=7.761..7.774 rows=100 loops=1) Sort Key: t1.fivethous Sort Method: quicksort Memory: 77kB\n</code>\næ’åºèŠ‚ç‚¹åŒ…å«æœ‰å…³ç”¨äºæ’åºçš„ç®—æ³•çš„ä¿¡æ¯ï¼Œ\nå¿«é€Ÿæ’åºï¼Œæ— è®ºæ’åºæ˜¯åœ¨å†…å­˜ä¸­è¿˜æ˜¯åœ¨ç£ç›˜ä¸Šå®Œæˆï¼ˆè¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Š\nå½±å“é€Ÿåº¦ï¼‰ï¼Œä»¥åŠæ‰€éœ€çš„å†…å­˜/ç£ç›˜ç©ºé—´é‡ã€‚\näº†è§£å¦‚ä½•è¯»å–æŸ¥è¯¢è®¡åˆ’å¯¹äºä¼˜åŒ–æŸ¥è¯¢éå¸¸æœ‰ç”¨ã€‚ å¯¹äº\nä¾‹å¦‚ï¼ŒSeq ScanèŠ‚ç‚¹é€šå¸¸è¡¨æ˜æœ‰æœºä¼šæ·»åŠ ç´¢å¼•ï¼Œ\né˜…è¯»èµ·æ¥è¦å¿«å¾—å¤šã€‚ ç†Ÿæ‚‰è¿™äº›è®¡åˆ’å°†ä½¿\næ‚¨æ˜¯æ›´å¥½çš„æ•°æ®åº“å·¥ç¨‹å¸ˆã€‚ æœ‰å…³æŸ¥è¯¢è®¡åˆ’çš„æ›´å¤šç¤ºä¾‹ï¼Œè¯·é˜…è¯»ä½¿ç”¨\nè§£é‡Šæœ¬ç¤ºä¾‹ã€‚\nç°åœ¨ï¼Œæ‚¨å¯ä»¥é˜…è¯»æŸ¥è¯¢è®¡åˆ’ï¼Œå­¦ä¹ å¦‚ä½•ä¼˜åŒ–æ€§èƒ½ã€‚\nå¦‚æœæ‚¨å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œæ‚¨å¯èƒ½è¿˜ä¼šå–œæ¬¢ï¼š\næŸ¥æ‰¾ç»„ä¸­æœ€æ—©/æœ€å¹´è½»çš„è®°å½•\nPostgreSQLæ€§èƒ½æ³¨æ„äº‹é¡¹\nPostgresç´¢å¼•ç±»å‹\nä½¿ç”¨ä»£ç å®¡æ ¸å‡çº§ä»£ç åº“\näº†è§£æˆ‘ä»¬å¦‚ä½•å¸®åŠ©æ‚¨äº†è§£ä»£ç çš„å½“å‰çŠ¶æ€\nè´¨é‡ï¼ŒåŠ å¿«äº¤ä»˜æ—¶é—´ï¼Œæé«˜å¼€å‘äººå‘˜çš„æ»¡æ„åº¦å’Œæ°´å¹³\næå‡æ‚¨çš„ç”¨æˆ·ä½“éªŒ\näº†è§£æœ‰å…³ä»£ç å®¡æ ¸çš„æ›´å¤šä¿¡æ¯\næœåŠ¡\nå®ä¾‹æ¢ç©¶\nèµ„æºèµ„æº\né›‡ç”¨æˆ‘ä»¬\næˆ‘ä»¬å…¬å¸\nç›®çš„\nåšå®¢\nåŠ å…¥æˆ‘ä»¬çš„å›¢é˜Ÿ\næ¨ç‰¹\nçš„GitHub\nè¿çƒ\nInstagramçš„\nÂ© 2020\nThoughtbotå…¬å¸\næœºå™¨äººå’Œæ€æƒ³æœºå™¨äººçš„è®¾è®¡æ˜¯çš„æ³¨å†Œå•†æ ‡ã€‚\nThoughtbotå…¬å¸\néšç§æ”¿ç­–\n"}

